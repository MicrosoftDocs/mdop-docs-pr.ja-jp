---
title: DaRT 10 の回復イメージの作成
description: DaRT 10 の回復イメージの作成
author: dansimp
ms.assetid: 173556de-2f20-4ea6-9e29-fc5ccc71ebd7
ms.reviewer: ''
manager: dansimp
ms.author: dansimp
ms.pagetype: mdop
ms.mktglfcycl: support
ms.sitesec: library
ms.prod: w10
ms.date: 08/30/2016
ms.openlocfilehash: ebb48ee140a6e3f70e05acd3f6affc6e3b71ff37
ms.sourcegitcommit: 354664bc527d93f80687cd2eba70d1eea024c7c3
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 06/26/2020
ms.locfileid: "10813210"
---
# DaRT 10 の回復イメージの作成


Microsoft 診断/回復ツールセット (DaRT) 10 をインストールした後、DaRT 10 の回復イメージを作成します。 回復イメージは Windows RE を起動します。これにより、DaRT ツールを起動することができます。 国際標準化機構 (ISO) ファイル、および Windows イメージング形式 (WIM) 画像を生成できます。 さらに、PowerShell を使用して、DaRT Recovery イメージウィザードで選択した設定を使用するスクリプトを生成することもできます。 後でスクリプトを使用して、同じ設定を使用して回復イメージを再構築することができます。 回復イメージには、さまざまな回復ツールが用意されています。 ツールの説明については、「 [DaRT 10 のツールの概要](overview-of-the-tools-in-dart-10.md)」を参照してください。

DaRT にコンピューターを起動した後、さまざまな DaRT ツールを実行して、コンピュータの診断と修復を試すことができます。 このセクションでは、DaRT リカバリ画像の作成プロセスについて説明し、イメージの一部として含めるツールと機能を選択できるようにします。

DaRT リカバリ画像を作成するには、次の2つの方法のいずれかを使用します。

-   Windows 環境で実行される DaRT 回復イメージウィザードを使用します。

-   必要な値を使用して、PowerShell スクリプトの例を変更します。 詳細については、「 [PowerShell スクリプトを使用して回復イメージを作成する方法](how-to-use-a-powershell-script-to-create-the-recovery-image-dart-10.md)」を参照してください。

書き込み可能な CD または DVD に ISO を書き込んだり、USB フラッシュドライブに保存したり、リモートパーティションまたは回復パーティションから DaRT を起動するために使用できる形式で保存したりすることができます。

作成した ISO イメージは、空の CD または DVD に書き込むことができます (コンピューターに CD または DVD ドライブがある場合)。 この目的でコンピューターにドライブがない場合は、Cd または Dvd の書き込みに使用する一般的なプログラムを使用できます。

## イメージのアーキテクチャを選んでパスを指定する


[Windows 10 メディア] ページで、32ビットまたは64ビットの DaRT 回復イメージを作成するかどうかを選択します。 32 32 ビットの DaRT 回復イメージと64ビットの Windows を使って、64ビットの DaRT 回復イメージを構築します。 単一のコンピューターを使用して、両方のアーキテクチャの種類の回復イメージを作成することはできますが、32ビットと64ビットの両方のアーキテクチャで動作する1つのイメージを作成することはできません。 また、Windows 10 のインストールメディアのパスも指定します。 作成する回復イメージのいずれかと一致するアーキテクチャを選びます。

**イメージのアーキテクチャを選んでパスを指定するには**

1.  [ **Windows 10 メディア**] ページで、次のいずれかを選択します。

    -   64ビットコンピューターの回復イメージを作成する場合は、[ **x64 (64 ビット) DaRT イメージの作成**] を選択します。

    -   32ビットコンピューターの回復イメージを作成する場合は、[ **x86 (32 ビット) DaRT イメージの作成**] を選択します。

2.  [ **Windows 10 &lt; 64 ビットまたは32ビット &gt; インストールメディアのルートパスを指定**してください] ボックスに、Windows 10 のインストールファイルのパスを入力します。 作成している回復イメージのアーキテクチャと一致するパスを使用します。

3.  **[次へ]** をクリックします。

## 回復イメージに含めるツールを選択する


[ツール] ページで、さまざまなツールを選択して回復イメージに含めることができます。 これらのツールは、エンドユーザーが DaRT イメージを起動したときに利用できます。 ただし、DaRT イメージの作成時にリモート接続を有効にした場合は、どのツールを使用するかに関係なく、ヘルプデスクの作業者がエンドユーザーのコンピューターに接続すると、すべてのツールが利用可能になります。

エンドユーザーによるこれらのツールへのアクセスを制限しながら、リモート接続ビューアーを使用してツールへのフルアクセスを保持するには、[ツール] ページでこれらのツールを選択しないでください。 エンドユーザーはリモート接続のみを使用できるようになり、回復イメージから除外したツールは表示されますが、アクセスはできなくなります。

**回復イメージに含めるツールを選ぶには**

1.  [**ツール**] ページで、画像に含める各ツールの横にあるチェックボックスをオンにします。

2.  **[次へ]** をクリックします。

## ヘルプデスクによるリモート接続を許可するかどうかを選ぶ


[リモート接続] ページでは、ヘルプデスクワーカーがエンドユーザーのコンピューターで DaRT ツールにリモート接続して実行できるようにするかどうかを選ぶことができます。 [診断/回復ツールセット] ウィンドウで、[リモート接続] オプションが利用可能なオプションとして表示されます。 ヘルプデスクのワーカーがリモート接続を確立した後、エンドユーザーのコンピューター上の DaRT ツールをリモートの場所から実行することができます。

**ヘルプデスクの担当者によるリモート接続を許可するかどうかを選ぶには**

1.  [**リモート接続**] ページで、[**リモート**接続を許可する] チェックボックスをオンにしてリモート接続を許可するか、チェックボックスをオフにしてリモート接続を禁止します。

2.  [**リモート接続を許可**する] チェックボックスをオフにした場合は、[**次へ**] をクリックします。 それ以外の場合は、次の手順に進み、リモート接続の構成を続行します。

3.  次のいずれかのオプションを選択してください:

    -   Windows で開いているポート番号を選択します。

    -   ポート番号を指定します。 このオプションを選択した場合は、オプションの下のフィールドに 1 ~ 65535 のポート番号を入力します。 このポート番号は、リモート接続を確立するときに使用されます。 競合の可能性を最小限に抑えるため、ポート番号を1024以上にすることをお勧めします。

4.  (オプション)**リモート接続のウェルカム**メッセージボックスに、リモート接続を確立するときにエンドユーザーが受信するカスタマイズされたメッセージを作成します。 メッセージの最大文字数は2048です。

5.  **[次へ]** をクリックします。

    DaRT ツールをリモートで実行する方法について詳しくは、「 [Dart リカバリ画像を使ってリモートコンピューターを回復する方法](how-to-recover-remote-computers-by-using-the-dart-recovery-image-dart-10.md)」をご覧ください。

## 回復イメージにドライバーを追加する


[詳細オプション] ページの [ドライバー] タブでは、コンピューターの修復時に必要になる可能性のあるその他のデバイスドライバーを追加できます。 通常、Windows 10 によって提供される記憶域またはネットワークコントローラーが含まれている場合があります。 ドライバーは、画像の作成時にインストールされます。

**重要** 含めるドライバーを選択するときは、ワイヤレス接続 (Bluetooth や 802.11 a/b/g/g など) が DaRT でサポートされていないことに注意してください。

 

**回復イメージにドライバーを追加するには**

1.  [**詳細設定] オプション**ページで、[**ドライバー** ] タブをクリックします。

2.  **[追加]** をクリックします。

3.  ドライバーに追加するファイルを参照し、[**開く**] をクリックします。

    **注** ドライバーファイルは、記憶域またはネットワークコントローラーの製造元によって提供されます。

     

4.  追加するすべてのドライバーについて、手順2と3を繰り返します。

5.  **[次へ]** をクリックします。

## 回復イメージに WinPE オプションパッケージを追加する


[詳細オプション] ページの [WinPE] タブで、DaRT イメージに WinPE オプションパッケージを追加できます。 これらのパッケージは Windows ADK に含まれています。これは、DaRT 回復イメージウィザードのインストール必須条件です。 選択できるツールはすべてオプションです。 [ツール] ページで選択したツールに基づいて、必要なパッケージが自動的に追加されます。

スクラッチ領域のサイズを指定することもできます。 スクラッチ領域とは、DaRT を実行するために確保された RAM ディスクスペースの量です。 スクラッチ領域は、エンドユーザーのハードディスクが利用できない場合に便利です。 追加のツールとドライバーを実行している場合は、スクラッチ領域を増やすことができます。

**回復イメージに WinPE オプションパッケージを追加するには**

1.  [**詳細オプション**] ページで、[ **WinPE** ] タブをクリックします。

2.  イメージに含める各パッケージの横にあるチェックボックスをオンにするか、[**名前**] チェックボックスをオンにしてすべてのパッケージを選択します。

3.  [**スクラッチ領域**] フィールドで、エンドユーザーのハードディスクが利用できない場合の DaRT の実行に割り当てる RAM ディスクスペースの量を選びます。

4.  **[次へ]** をクリックします。

## クラッシュアナライザーのデバッグツールを追加する


ISO イメージに Crash Analyzer ツールを含める場合は、Windows 用のデバッグツールも含める必要があります。 [詳細オプション] ページの [Crash Analyzer] タブで、Windows 10 デバッグツールのパスを入力します。これは、Crash Analyzer でメモリダンプファイルを分析するために使用されます。 DaRT 回復イメージウィザードを実行しているコンピューター上のツールを使用することも、エンドユーザーのコンピューター上のツールを使用することもできます。 エンドユーザーコンピューターでツールを使用することにした場合、診断するすべてのコンピューターに、デバッグツールがインストールされている必要があります。

Microsoft Windows ソフトウェア開発キット (SDK) または Microsoft Windows 開発キット (WDK) をインストールした場合は、Windows 10 デバッグツールが既定で回復イメージに追加され、デバッグツールへのパスが自動的に入力されます。 既定のファイルパスで示されている場所以外の場所にファイルがある場合は、Windows 10 デバッグツールのパスを変更することができます。 ウィザードのリンクにより、Windows 用のデバッグツールがまだインストールされていない場合は、ダウンロードしてインストールできます。

Windows デバッグツールをダウンロードするには、「 [windows 用デバッグツール](https://go.microsoft.com/fwlink/?LinkId=266248)」を参照してください。 既定の場所にデバッグツールをインストールします。

**注** DaRT ウィザードは、レジストリキーのツールをチェックし `HKLM\Software\Microsoft\Windows Kits\Installed Roots\WindowsDebuggersRoot` ます。 レジストリ値が存在しない場合、ウィザードはシステムアーキテクチャに応じて次のいずれかの場所を検索します。

`%ProgramFilesX86%\Windows Kits\10.0\Debuggers\x64`

`%ProgramFilesX86%\Windows Kits\10.0\Debuggers\x86`

 

**クラッシュアナライザーのデバッグツールを追加するには**

1.  [**詳細オプション**] ページで、[**クラッシュアナライザー** ] タブをクリックします。

2.  省略[**デバッグツールのダウンロード**] をクリックして、Windows 用のデバッグツールをダウンロードします。

3.  次のいずれかのオプションを選択します。

    -   **Windows 10 の &lt; 64 ビットまたは32ビットの &gt; デバッグツールを含め**ます。 このオプションを選択した場合は、パスがまだ表示されていない場合は、ツールの場所を参照して選択します。

    -   デバッグ**するシステムのデバッグツールを使い**ます。 このオプションを選択すると、Windows 用デバッグツールが問題のコンピューターで見つからない場合に、クラッシュアナライザーが機能しなくなります。

4.  **[次へ]** をクリックします。

## 作成する回復イメージファイルの種類を選択する


[イメージの作成] ページで、回復イメージの出力フォルダーを選び、画像名を入力して、作成する DaRT 回復イメージファイルの種類を選びます。 回復イメージの作成プロセス中に、Windows ソースファイルが展開され、DaRT ファイルがそのファイルにコピーされ、このページで選択したファイル形式でイメージが再パックされます。

使用できる画像ファイルの種類は次のとおりです。

-   **Windows Imaging File (WIM)** -DaRT をプレブート実行環境 (PXE) またはローカルパーティションに展開するために使用されます。

-   **国際標準化機構 (ISO)** – CD または DVD に展開したり、仮想マシン (VM) で使用したりするために使用されます。 この機能を使うには、CD または DVD に書き込むほとんどのプログラムにこの拡張子が必要であるため、ISO の画像に .iso ファイル名の拡張子が付いている必要があります。 別の場所を指定しない場合は、DaRT10 名前の付いた ISO 画像がデスクトップに作成されます。

-   **PowerShell スクリプト**– Dart リカバリ画像ウィザードを使用して選択できるのと同じオプションを提供する dart リカバリ画像を作成します。 このスクリプトでは、DaRT リカバリ画像のファイルを追加または変更することもできます。

このページで [イメージの編集] チェックボックスをオンにした場合、イメージの作成プロセス中に回復イメージをカスタマイズできます。 たとえば、"winpeshl.ini" ファイルを変更して、カスタムの起動順序を作成したり、サードパーティ製のツールを追加したりできます。

**作成する回復イメージファイルの種類を選ぶには**

1.  [**イメージの作成**] ページで [**参照**] をクリックして、画像ファイルの出力フォルダーを選びます。

    **注** 画像のサイズは、選んだツールとウィザードで追加したファイルによって異なります。

     

2.  [**イメージ名**] ボックスに DaRT リカバリ画像の名前を入力するか、既定の名前 (DaRT10) をそのまま使用します。

    ウィザードによって、この名前の出力パス内にサブフォルダーが作成されます。

3.  作成する画像ファイルの種類を選択します。

4.  次のいずれかのオプションを選びます。

    -   イメージファイルを作成する前に回復イメージのファイルを変更するには、[**イメージの編集**] チェックボックスをオンにし、[**準備**] をクリックします。

    -   ファイルを変更せずに回復イメージを作成するには、[**作成**] をクリックします。

5.  

    **[次へ]** をクリックします。

## 回復イメージファイルを編集する


回復イメージを編集できるのは、[イメージの作成] ページの [イメージの編集] チェックボックスをオンにした場合のみです。 回復イメージを編集する準備ができたら、起動可能なメディアを作成する前に、回復イメージファイルを追加して変更することができます。 たとえば、スタートアップのカスタム注文を作成したり、さまざまなサードパーティ製のツールを追加したりすることができます。

**回復イメージファイルを編集するには**

1.  [**イメージの編集**] ページで、[Windows エクスプローラーで**開く**] をクリックします。

2.  このダイアログボックスに表示されているフォルダー内にサブフォルダーを作成します。

3.  目的のファイルを新しいサブフォルダーにコピーするか、不要なファイルを削除します。

4.  [**作成**] をクリックして、回復イメージの作成を開始します。

## 回復イメージファイルを生成する


[ファイルの生成] ページで、[イメージの作成] ページで選択したファイルの種類に対応する DaRT 回復イメージが生成されます。

**回復イメージファイルを生成するには**

-   [**ファイルの生成**] ページで、[**次**へ] をクリックして、回復イメージファイルを生成します。

## 回復イメージを CD、DVD、または USB にコピーする


[起動可能なメディアの作成] ページでは、必要に応じて、画像ファイルを CD、DVD、または USB フラッシュドライブ (UFD) にコピーできます。 ウィザードを再起動して、このページから追加の起動可能なメディアを作成することもできます。

**注** プレブート実行環境 (PXE) とローカルイメージ展開は、このツールでネイティブにサポートされていません。そのため、System Center Configuration Manager サーバーや Microsoft 開発ツールキットなどの追加のエンタープライズツールが必要です。

 

**回復イメージを CD、DVD、または USB にコピーするには**

1.  [**ブータブルメディアの作成**] ページで、コピーする iso ファイルを選びます。

2.  CD、DVD、または USB を挿入して、ドライブを選びます。

    **注** ドライブが認識されず、新しいドライブをインストールする場合は、[**更新**] をクリックして、利用可能なドライブの一覧を自動的に更新することができます。

     

3.  [**ブート可能なメディアを作成する**] ボタンをクリックします。

4.  別の回復イメージを作成するには、[再起動] をクリックするか、必要なすべてのメディアの作成が完了したら、[**閉じる**] をクリックします。

## 関連トピック


[DaRT 10 のツールの概要](overview-of-the-tools-in-dart-10.md)

[DaRT 10 の展開](deploying-dart-10.md)

 

 





