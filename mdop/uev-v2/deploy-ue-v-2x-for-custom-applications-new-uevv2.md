---
title: カスタムアプリケーションの UE-V 2. x の展開
description: カスタムアプリケーションの UE-V 2. x の展開
author: dansimp
ms.assetid: f7cb089f-d764-4a93-82b6-926fe0385a23
ms.reviewer: ''
manager: dansimp
ms.author: dansimp
ms.pagetype: mdop, virtualization
ms.mktglfcycl: deploy
ms.sitesec: library
ms.prod: w10
ms.date: 07/19/2016
ms.openlocfilehash: 217f647d948df016c4a6b72736669c2b3305b705
ms.sourcegitcommit: 354664bc527d93f80687cd2eba70d1eea024c7c3
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 06/26/2020
ms.locfileid: "10824404"
---
# カスタムアプリケーションの UE-V 2. x の展開


Microsoft User Experience Virtualization (UE-V) 2.0。 2.1 と 2.1 SP1 では、**設定場所テンプレート**と呼ばれる XML ファイルを使用して、デスクトップアプリケーションの設定と Windows デスクトップの設定を監視および同期します。 既定では、いくつかの設定場所テンプレートが UE-V に含まれています。 ただし、既定のテンプレートに含まれていないデスクトップアプリケーションの設定を同期する場合は、UE-V Generator を使って、独自のカスタム設定の場所テンプレートを作成できます。

「 [Ue-v の展開を準備](prepare-a-ue-v-2x-deployment-new-uevv2.md)する」の計画資料に目を通して、カスタムアプリケーション (サードパーティ、基幹業務など) の設定を同期することにした場合は、このトピックで説明するように、ue-v の機能を展開します。 まず、カスタムアプリケーションの設定を同期するために必要な主な手順を示します。

-   [UEV Generator をインストールする](#uevgen)

    UEV Generator を使って、カスタム XML 設定の場所テンプレートを作成します。

-   [UE-V 設定テンプレートカタログを構成する](#deploycatalogue)

    このパスは、カスタム設定の場所テンプレートが保存されている場所で定義できます。

-   [カスタム設定の場所テンプレートを作成する](#createcustomtemplates)

    これらのカスタムテンプレートを使用すると、ユーザーはカスタムアプリケーションの設定を同期できます。

-   [カスタム設定の場所テンプレートを展開する](#deploycustomtemplates)

    カスタムテンプレートをテストして、設定が正しく同期されていることを確認したら、次のいずれかの方法でこれらのテンプレートを展開できます。

    -   既存の展開インフラストラクチャ (構成マネージャーなど)

    -   グループポリシーの基本設定を使用する

    -   [UE-V 設定テンプレートカタログを展開する](#deploycatalogue)

    **注** ESD またはグループポリシーを使用して展開されるテンプレートは、UE-V Windows Management Instrumentation (WMI) または Windows PowerShell に登録する必要があります。

     

## カスタムアプリケーションの UE-V 2 x の展開を準備する


カスタムアプリケーションを処理する UE-V 機能の展開を開始する前に、いくつかの点を確認する必要があります。

### UE-V Generator

UE-V Generator は、アプリケーションがその設定を保存する場所を検出し、キャプチャするために、アプリケーションを監視します。 監視されるアプリケーションは、従来のアプリケーションである必要があります。 次の種類のアプリケーションでは、UE-V Generator を使って設定位置テンプレートを作成できますが、設定場所テンプレートを作成することはできません。

-   仮想化されたアプリケーション

-   ターミナルサービスを通じて提供されるアプリケーション

-   Java アプリケーション

-   Windows アプリ  

**注** UE-V settings location テンプレートは、仮想化されたアプリケーションまたはターミナルサービスアプリケーションから作成することはできません。 ただし、テンプレートを使用して同期された設定は、それらのアプリケーションに適用することができます。 仮想デスクトップインフラストラクチャ (VDI) とターミナルサービスアプリケーションをサポートするテンプレートを作成するには、UE-V Generator を使って、アプリケーションのバージョンの Windows インストーラー (.msi) パッケージを開きます。 仮想アプリケーションの同期設定の詳細については、「 [Application Virtualization アプリケーションを使った ue-v の使用](using-ue-v-2x-with-application-virtualization-applications-both-uevv2.md)」を参照してください。

 

**除外する場所:** 検出プロセスでは、ユーザーのコンピューターまたはコンピューティング環境の間で設定が適切に同期されない、一般的にアプリケーションソフトウェアファイルを保存する場所を除外します。 既定では、次のように除外されます。

-   HKEY \ _CURRENT \ _USER のレジストリキーと、ログオンしたユーザーが値を書き込むことができないファイル

-   HKEY \ _CURRENT \ _USER のレジストリキーと、Windows オペレーティングシステムのコア機能に関連付けられているファイル

-   HKEY \ _LOCAL \ _MACHINE ハイブにあるすべてのレジストリキー

-   Program Files ディレクトリにあるファイル

-   ユーザーに保存されているファイル (\ \ [ユーザー名 \] \)

-   % Systemroot% にある Windows オペレーティングシステムファイル

除外された場所に格納されているレジストリキーとファイルがアプリケーション設定を同期するために必要な場合は、テンプレートの作成プロセス中に場所を手動で設定場所テンプレートに追加できます。
ただし、HKEY \ _CURRENT \ _USER ハイブに対する変更のみが同期されます。

### 既定の Microsoft テンプレートを置き換える

UE-V Agent は、一般的な Microsoft アプリケーションと Windows 設定用の設定場所テンプレートの既定のグループをインストールします。 これらのテンプレートをカスタマイズしたり、設定の場所テンプレートを作成してカスタムアプリケーションの設定を同期したりする場合、UE-V Agent は、設定テンプレートカタログを使用してテンプレートを保存するように構成できます。 この場合は、[設定] テンプレートカタログに、既定のテンプレートとカスタムテンプレートを含める必要があります。

[Ue-v agent を展開](https://technet.microsoft.com/library/dn458891.aspx#agent)するときは、コマンドラインパラメーターを使用して、 `RegisterMSTemplates` 既定の Microsoft テンプレートの登録を無効にすることができます。

グループポリシーを使用して設定テンプレートカタログのパスを構成する場合は、既定の Microsoft テンプレートを置き換えるかどうかを選ぶことができます。 既定の Microsoft テンプレートを置き換えるようにポリシー設定を構成した場合、UE-V Agent によってインストールされた既定の Microsoft テンプレートはすべて削除され、設定テンプレートカタログ内にあるテンプレートだけが使用されます。 既定の Microsoft テンプレートを上書きするには、UE-V Agent 構成設定パラメーターを `RegisterMSTemplates` *true*に設定する必要があります。

**注** 有効にした後にこのポリシー設定を無効にした場合、UE-V Agent では既定の Microsoft テンプレートは復元されません。

 

既定の Microsoft テンプレートと同じ ID を使用するように設定テンプレートカタログにカスタマイズされたテンプレートがあり、UE-V Agent が既定の Microsoft テンプレートと置き換えるように構成されていない場合、Microsoft テンプレートは無視されます。

UE-V Windows PowerShell 機能を使用して、既定のテンプレートを置き換えることもできます。 既定の Microsoft テンプレートを Windows PowerShell に置き換えるには、既定の Microsoft テンプレートの登録を解除し、カスタマイズされたテンプレートを登録します。

**注** アプリケーションに新しい設定場所のテンプレートを展開しても、古い設定パッケージは [設定の保存] の場所に残ります。 これらのパッケージはエージェントによって読み取られることはありませんが、自動的に削除されることはありません。

 

## <a href="" id="uevgen"></a>UEV Generator ジェネレーターをインストールする


コンピューターに Microsoft User Experience Virtualization (UE-V) 2.0 ジェネレーターをインストールします。これを使用すると、カスタム設定の場所テンプレートを作成できます。 このコンピューターには、カスタム設定の場所テンプレートを生成するアプリケーションがインストールされている必要があります。

**UE-V Generator をインストールするには**

1.  ローカル管理者の権限を持つユーザーとして、UE-V ソフトウェアで提供されている UE-V Generator のインストールファイル**ToolSetup.exe**見つけます。 または、コンピューターのアーキテクチャがわかっている場合は、適切な Windows インストーラー (.msi) ファイル、 **ToolsSetupx64.msi**または**ToolsSetupx86.msi**を実行できます。

2.  インストールファイルをダブルクリックします。 ユーザーエクスペリエンス仮想化ジェネレーターのセットアップウィザードが開きます。 **[Next]** をクリックして続行します。

3.  Microsoft ソフトウェアライセンス条項に同意し、[**次へ**] をクリックします。

4.  Microsoft Update とカスタマーエクスペリエンス向上プログラムのオプションをクリックします。

5.  UE-V Generator をインストールする保存先フォルダーを選択し、[**次へ**] をクリックします。

6.  インストールを開始するには、[**インストール**] をクリックします。

    **注** アプリケーションがインストールされる前に、**ユーザーアカウント制御**のプロンプトが表示されます。 UE-V Generator をインストールするには、アクセス許可が必要です。

     

7.  インストールが完了したら、[**完了**] をクリックしてウィザードを閉じます。 UE-V Generator を実行するには、コンピューターを再起動する必要があります。

    インストールが正常に完了したことを確認するには、[**スタート**]、[**すべてのプログラム**]、[ **microsoft user Experience Virtualization**]、[ **microsoft user experience virtualization Generator**] の順にクリックします。

    **注** UE-V 2 ジェネレーターは、UE-V 2 エージェントのテンプレートを作成するためにのみ使用できます。 UE-V 1.0 エージェントと UE-V 2 エージェントの混在型展開では、すべての UE-V エージェントをアップグレードするまで、引き続き UE-V 1.0 ジェネレーターを使用する必要があります。

     

## <a href="" id="deploycatalogue"></a>設定テンプレートカタログを展開する


ユーザーエクスペリエンスの仮想化設定テンプレートカタログは、カスタム設定の場所テンプレートをすべて保存する、UE-V のコンピューター上のフォルダーパスまたはサーバーメッセージブロック (SMB) ネットワーク共有です。 UE-V Agent のスケジュールされたタスクでは、この場所が毎日1回チェックされ、このフォルダー内のテンプレートに基づいて同期動作が更新されます。

UE-V Agent は、前回フォルダーがチェックされ、削除されたテンプレートの登録を解除した後に、このフォルダーに追加または更新されたテンプレートを登録します。 既定では、テンプレートは1日に1回、午前3:30 時に登録および登録解除されます。 タスクスケジューラとシステム起動時のローカル時刻。 このスケジュールされたタスクの頻度をカスタマイズする方法については、「 [ue-v のスケジュールされたタスクの頻度を変更](changing-the-frequency-of-ue-v-2x-scheduled-tasks-both-uevv2.md)する」を参照してください。

インストールコマンドラインオプション、グループポリシー、WMI、または Windows PowerShell を使用して、設定テンプレートカタログのパスを構成できます。 設定テンプレートカタログパスに保存されているテンプレートは、スケジュールされたタスクによって自動的に登録および登録解除されます。

**UE-V 2. x の設定テンプレートカタログを構成するには**

1.  UE-V 設定テンプレートカタログが保存されているコンピューターに新しいフォルダーを作成します。

2.  設定テンプレートカタログフォルダーに対して、次の共有レベル (SMB) のアクセス許可を設定します。

    <table>
    <colgroup>
    <col width="50%" />
    <col width="50%" />
    </colgroup>
    <thead>
    <tr class="header">
    <th align="left"><strong>ユーザーアカウント</strong></th>
    <th align="left"><strong>推奨されるアクセス許可</strong></th>
    </tr>
    </thead>
    <tbody>
    <tr class="odd">
    <td align="left"><p>すべてのユーザー</p></td>
    <td align="left"><p>権限なし</p></td>
    </tr>
    <tr class="even">
    <td align="left"><p>ドメインコンピューター</p></td>
    <td align="left"><p>アクセス許可レベルの読み取り</p></td>
    </tr>
    <tr class="odd">
    <td align="left"><p>管理者</p></td>
    <td align="left"><p>読み取り/書き込みアクセス許可レベル</p></td>
    </tr>
    </tbody>
    </table>

     

3.  設定テンプレートカタログフォルダーに対して、次の NTFS ファイルシステム権限を設定します。

    <table>
    <colgroup>
    <col width="33%" />
    <col width="33%" />
    <col width="33%" />
    </colgroup>
    <thead>
    <tr class="header">
    <th align="left">ユーザーアカウント</th>
    <th align="left">推奨されるアクセス許可</th>
    <th align="left">適用対象</th>
    </tr>
    </thead>
    <tbody>
    <tr class="odd">
    <td align="left"><p>作成者/所有者</p></td>
    <td align="left"><p>フルコントロール</p></td>
    <td align="left"><p>このフォルダー、サブフォルダー、ファイル</p></td>
    </tr>
    <tr class="even">
    <td align="left"><p>ドメインコンピューター</p></td>
    <td align="left"><p>フォルダーの内容の一覧表示と読み取り</p></td>
    <td align="left"><p>このフォルダー、サブフォルダー、ファイル</p></td>
    </tr>
    <tr class="odd">
    <td align="left"><p>すべてのユーザー</p></td>
    <td align="left"><p>権限なし</p></td>
    <td align="left"><p>権限なし</p></td>
    </tr>
    <tr class="even">
    <td align="left"><p>管理者</p></td>
    <td align="left"><p>フルコントロール</p></td>
    <td align="left"><p>このフォルダー、サブフォルダー、ファイル</p></td>
    </tr>
    </tbody>
    </table>

     

4.  [ **OK** ] をクリックしてダイアログボックスを閉じます。

少なくとも、ネットワーク共有は、ドメインコンピューターグループに対するアクセス許可を付与する必要があります。 さらに、保存されたテンプレートを管理する管理者に、ネットワーク共有フォルダーへのアクセス許可を付与します。

## <a href="" id="createcustomtemplates"></a>カスタム設定の場所テンプレートを作成する


UE-V Generator を使って、基幹業務アプリケーションやその他のカスタムアプリケーションの設定場所テンプレートを作成します。 アプリケーションのテンプレートが作成されたら、それをコンピューターに展開することで、そのアプリケーションの設定が同期されるようにすることができます。

**Ue-v Generator を使用して UE-V 設定の場所テンプレートを作成するには**

1.  [**スタート**] をクリックし、[**すべてのプログラム**]、[ **microsoft user Experience Virtualization**]、[ **microsoft user experience virtualization Generator**] の順にクリックします。

2.  [**設定場所テンプレートの作成] を**クリックします。

3.  アプリケーションを指定します。 設定場所テンプレートを作成するアプリケーション (.exe) またはアプリケーションショートカット (.lnk) のファイルパスを参照します。 必要に応じて、コマンドライン引数 (存在する場合) と作業ディレクトリを指定します。 **[Next]** をクリックして続行します。

    **注** アプリケーションが起動する前に、システムによって**ユーザーアカウント制御**のプロンプトが表示されます。 レジストリと、アプリケーションが設定を保存するために使用するファイルの場所を監視するには、アクセス許可が必要です。

     

4.  アプリケーションが起動したら、アプリケーションを閉じます。 UE-V Generator は、アプリケーションの設定が保存されている場所を記録します。

5.  処理が完了したら、[**次へ**] をクリックして続行します。

6.  このアプリケーションで同期する、適切なレジストリ設定の場所と設定ファイルの場所の横にあるチェックボックスを確認して選択します。 この一覧には、設定場所に関する次の2つのカテゴリが含まれています。

    -   **標準**: HKEY \ _CURRENT \ _USER キーの下にあるレジストリに保存されているアプリケーション設定、または \\**ユーザー** \ \ \ [ユーザー名 \] **\ \ の**ファイルフォルダーの下にあり  \\  **Roaming**ます。 UE-V Generator では、これらの設定が既定で含まれています。

    -   **非標準**: 場所以外に保存されているアプリケーション設定は、[設定] データストレージのベストプラクティスで指定されています (省略可能)。 これには、**ユーザー** \ \ \ [ユーザー名 \] \ \ **AppData**ローカルのファイルとフォルダーが含ま  \\  **Local**れます。 これらの場所を確認して、設定場所テンプレートに含めるかどうかを決定します。 [場所] チェックボックスをオンにして追加します。

    **[Next]** をクリックして続行します。

7.  設定場所テンプレートの**プロパティ**、**レジストリ**の場所、**ファイル**の場所を確認して編集します。

    -   [**プロパティ**] タブで、次のプロパティを編集します。

        -   [ **Application name**]: program files プロパティの説明に記載されているアプリケーション名。

        -   [ **Program name**]: プログラムファイルのプロパティから取得したプログラムの名前。 通常、この名前には .exe ファイル名拡張子が付きます。

        -   [**製品バージョン**: アプリケーションの .exe ファイルの製品バージョン番号。 このプロパティは、**ファイルバージョン**と組み合わせて、設定場所テンプレートのターゲットとなるアプリケーションを決定するのに役立ちます。 このプロパティは、メジャーバージョン番号を受け取ります。 このプロパティが空の場合、[設定の場所] テンプレートは製品のすべてのバージョンに適用されます。

        -   **ファイルのバージョン**: アプリケーションの .exe ファイルのファイルバージョン番号。 このプロパティは**製品バージョン**と組み合わせて、設定場所テンプレートのターゲットとなるアプリケーションを決定するのに役立ちます。 このプロパティは、メジャーバージョン番号を受け取ります。 このプロパティが空の場合は、設定の場所テンプレートがプログラムのすべてのバージョンに適用されます。

        -   **テンプレート作成者の名前**(省略可能): 設定場所テンプレートの作成者の名前。

        -   **テンプレート作成者のメール**(オプション): 設定場所テンプレートの作成者のメールアドレス。

    -   [**レジストリ**] タブには、設定場所テンプレートに含まれているレジストリの場所の**キー**と**範囲**が一覧表示されます。 [**タスク**] ドロップダウンメニューを使用して、レジストリの場所を編集します。 タスクを使用すると、新しいキーの追加、既存のキーの名前または範囲の編集、キーの削除、キーが存在する場所のレジストリの参照を行うことができます。 すべての**設定**のスコープを使用して、指定したキーの下にすべてのレジストリ設定を追加します。 すべての**設定とサブ**キーを使用して、指定したキー、サブキー、サブキーの設定の下にすべてのレジストリ設定を含めることができます。

    -   [**ファイル**] タブには、設定場所テンプレートに含まれているファイルの場所のファイルパスとファイルマスクが一覧表示されます。 [**タスク**] ドロップダウンメニューを使用して、ファイルの場所を編集します。 ファイルの場所のタスクでは、新しいファイルまたはフォルダーの場所を追加したり、既存のファイルまたはフォルダーの範囲を編集したり、ファイルまたはフォルダーを削除したり、エクスプローラーで選択した場所を開くことができます。 指定したフォルダー内のすべてのファイルを含めるには、[ファイルマスク] を空のままにします。

8.  [**作成**] をクリックし、[**保存**] をクリックして、コンピューターに設定の場所テンプレートを保存します。

9.  [**閉じる**] をクリックして、設定テンプレートウィザードを閉じます。 UE-V Generator アプリケーションを終了します。

    アプリケーションの設定場所テンプレートを作成したら、テンプレートをテストする必要があります。 ラボ環境にテンプレートを展開してから、エンタープライズで実働環境に配置します。

[Ue-v のアプリケーションテンプレートスキーマリファレンス](https://technet.microsoft.com/library/dn763947.aspx)では、ue-v 設定の場所テンプレートの XML 構造について詳しく説明し、これらのファイルを編集するためのガイダンスを提供します。

## <a href="" id="deploycustomtemplates"></a>カスタム設定の場所テンプレートを展開する


UE-V Generator を使用して設定場所テンプレートを作成したら、アプリケーションの設定が正しく同期されていることを確認するためにテストする必要があります。 次に、エンタープライズ内のコンピューターに設定場所テンプレートを安全に展開できます。

設定場所テンプレートは、次のいずれかの方法を使用して展開できます。

-   System Center Configuration Manager などのエンタープライズソフトウェア配布 (ESD) システム

-   グループ ポリシーの基本設定

-   UE-V 設定テンプレートカタログ

ESD システムまたはグループポリシーオブジェクトを使用して展開されるテンプレートは、UE-V Windows Management Instrumentation (WMI) または Windows PowerShell を使って登録する必要があります。 設定テンプレートカタログの場所に保存されているテンプレートは、UE-V Agent によって自動的に登録されます。

**設定テンプレートカタログパスを使用して UE-V 設定の場所テンプレートを展開するには**

1.  設定テンプレートカタログとして定義されているネットワーク共有フォルダーを参照します。

2.  UE-V のコンピューターに必要な UE-V Agent テンプレートの構成を反映するために、設定テンプレートカタログの設定場所テンプレートを追加、削除、または更新します。

    **注** コンピューター上のテンプレートが毎日更新されます。 更新プログラムは、設定テンプレートカタログの変更に基づいています。

     

3.  UE-V Agent を実行しているコンピューター上でテンプレートを手動で更新するには、管理者特権のコマンドプロンプトを開き、 **% Program files% ¥ Microsoft User Experience Virtualization \ \ Agent \ \ &lt; x86 または x64 &gt; **を参照して、 **ApplySettingsTemplateCatalog.exe**を実行します。

    **注** このプログラムは、コンピューターの3:30 起動時に自動的に実行されます。 カタログに最近追加された新しいテンプレートを収集します。

     






## 関連トピック


[UE-V の展開を準備する](prepare-a-ue-v-2x-deployment-new-uevv2.md)

[UE-V 2.x の必要な機能を展開する](deploy-required-features-for-ue-v-2x-new-uevv2.md)

 

 





