---
title: MED-V 仮想ハード ディスクの最適化
description: MED-V 仮想ハード ディスクの最適化
author: dansimp
ms.assetid: 5e6122d1-9847-4b33-adab-594919eec3c5
ms.reviewer: ''
manager: dansimp
ms.author: dansimp
ms.pagetype: mdop, virtualization
ms.mktglfcycl: deploy
ms.sitesec: library
ms.prod: w10
ms.date: 06/16/2016
ms.openlocfilehash: f71aefb1e4e901078b4d0a421065b7bd5acdf0ee
ms.sourcegitcommit: 354664bc527d93f80687cd2eba70d1eea024c7c3
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 06/26/2020
ms.locfileid: "10823277"
---
# MED-V 仮想ハード ディスクの最適化


必須ではありませんが、仮想ハードディスク (VHD) を圧縮して、Windows 仮想 PC イメージを構成する前に、空のディスク領域を再利用し、VHD のサイズを小さくすることができます。

**重要** 続行する前に、Windows XP イメージのバックアップコピーを作成します。

 

**仮想ハードディスクの準備**

1.  Windows XP のイメージを開きます。

    [**スタート**] をクリックし、[**すべてのプログラム**]、[ **windows 仮想 Pc**]、[ **windows 仮想**pc] の順にクリックして、windows XP のイメージをダブルクリックします。

2.  DLL キャッシュをクリアします。

    1.  仮想マシンのコマンドプロンプトで、「 **sfc/cachesize = 1**」と入力します。

    2.  仮想マシンを再起動します。

    3.  仮想マシンのコマンドプロンプトで、「 **sfc/purgecache**」と入力します。

3.  アンインストーラー、一時ファイル、ログファイル、ページファイル、共有フォルダーなどの不要なファイルを削除します。

4.  システムの復元をオフにします。 この手順は、Sysprep.inf ファイルで指定することもできます。

    1.  **コントロールパネル**で、[**システム**] をダブルクリックし、[**システムの復元**] タブを選択します。

    2.  [**システムの復元をオフにする**] を選び、[ **OK**] をクリックします。

5.  イベントログの最大サイズを設定し、すべてのイベントを消去します。

    1.  イベントビューアーを開きます。

        [**スタート**] をクリックし、[**コントロールパネル**] をクリックし、[**管理ツール**] をダブルクリックして、[**イベントビューアー**] をダブルクリックします。

    2.  [**アプリケーション**] を右クリックし、[**プロパティ**] をクリックします。

    3.  [ **Log size** ] 領域で、[ **Maximum Log size** ] を [512kb] に設定し、[**必要に応じてイベントを上書き**する] を選択します。

    4.  [**ログの消去**] をクリックします。 [**イベントビューアー** ] ダイアログボックスが表示されたら、[**いいえ**] をクリックします。

    5.  [**プロパティ**] ウィンドウで、[ **OK]** をクリックします。

    6.  **セキュリティ**と**システム**ログについて、手順 a ~ e を繰り返します。

6.  ディスククリーンアップツールを実行します。

    [**スタート**] をクリックし、[**すべてのプログラム**]、[**アクセサリ**]、[**システムツール**]、[**ディスククリーンアップ**] の順にクリックします。

7.  必要に応じて、アプリケーションでページファイルを構成します。

    1.  **コントロールパネル**で、[**システム**] をダブルクリックし、[**詳細設定**] タブを選択します。

    2.  [**パフォーマンス**] 領域で、[**設定**] をクリックします。

    3.  [**仮想メモリ**] 領域で、[**変更**] をクリックします。

    4.  ページファイルの設定を構成します。

8.  Windows XP のイメージをシャットダウンします。

**仮想ハードディスクの最適化と最適化前の方法**

1.  Windows 7 を実行しているホストコンピューターの**コントロールパネル**で、[**管理ツール**] をクリックし、[**コンピューターの管理**] をダブルクリックして、[ディスクの**管理**] をクリックします。

2.  ディスク管理コンソールを使用して、仮想ハードディスクを接続 (マウント) し、ディスクを最適化します。

3.  ISO 抽出ツールを使用して、\\ プログラムファイル \\ Windows 仮想デバイス \\ 統合コンポーネントフォルダーにある precompact .iso を抽出します。

4.  precompact.exe プログラムを使用して、Windows XP の仮想ハードディスクを圧縮します。

5.  ディスク管理コンソールを使用して、仮想ハードディスクをデタッチします。

**仮想ハードディスクの最適化**

1.  Windows 仮想 PC を開きます。

    [**スタート**] をクリックし、[**すべてのプログラム**]、[ **windows 仮想 Pc**]、[ **windows 仮想 pc**] の順にクリックします。

2.  Windows XP の画像を右クリックして、[**設定**] を選択します。

3.  Windows XP のイメージに対応する [**ハードディスク**] をクリックし、[**変更**] をクリックします。

4.  [**コンパクト仮想ハードディスク**] をクリックします。

5.  [**圧縮**] をクリックし、[ **OK]** をクリックします。

最適化した仮想ハードディスクのバックアップコピーを作成します。

## 関連トピック


[MED-V の Windows 仮想 PC イメージの構成](configuring-a-windows-virtual-pc-image-for-med-v.md)

[MED-V テクニカル リファレンス](technical-reference-for-med-v.md)

 

 





