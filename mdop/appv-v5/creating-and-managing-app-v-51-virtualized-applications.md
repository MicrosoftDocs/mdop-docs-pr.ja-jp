---
title: App-V 5.1 仮想化アプリケーションの作成と管理
description: App-V 5.1 仮想化アプリケーションの作成と管理
author: dansimp
ms.assetid: 26be4331-88eb-4cfb-9d82-e63d7ee54576
ms.reviewer: ''
manager: dansimp
ms.author: dansimp
ms.pagetype: mdop, appcompat, virtualization
ms.mktglfcycl: deploy
ms.sitesec: library
ms.prod: w10
ms.date: 06/16/2016
ms.openlocfilehash: 207529fb5d5333694d31a82f44f08b35513dd4d4
ms.sourcegitcommit: 354664bc527d93f80687cd2eba70d1eea024c7c3
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 06/26/2020
ms.locfileid: "10814690"
---
# App-V 5.1 仮想化アプリケーションの作成と管理


Microsoft Application Virtualization (App-v) 5.1 sequencer を適切に展開したら、それを使って、仮想化されたアプリケーションとして実行するアプリケーションのインストールとセットアップのプロセスを監視および記録することができます。

**注** App-v 5.1 sequencer の構成、シーケンスのベストプラクティス、仮想アプリケーションの作成と更新の例については、「 [Microsoft Application Virtualization 5.0 シーケンスガイド](https://download.microsoft.com/download/F/7/8/F784A197-73BE-48FF-83DA-4102C05A6D44/App-V%205.0%20Sequencing%20Guide.docx)」を参照してください。

**注**App-v Sequencer は、"CO_ x" と一致するファイル名を使ったアプリケーションのシーケンスを行うことはできません &lt; &gt; 。 x は任意の数字です。 エラー0x8007139F が生成されます。

## アプリケーションのシーケンス


App-v 5.1 Sequencer を使用して、次のタスクを実行できます。

-   App-v 5.1 クライアントを実行しているコンピューターに展開できる仮想パッケージを作成します。

-   既存のパッケージをアップグレードします。 Sequencer を実行しているコンピューター上に既存のパッケージを展開してから、アプリケーションをアップグレードして新しいバージョンを作成することができます。

-   既存のパッケージに関連付けられた構成情報を編集します。 たとえば、ショートカットを追加したり、ファイルの種類の関連付けを変更したりすることができます。

    **注** ローミングを許可するには、ショートカットを作成し、利用可能なネットワーク上の場所に保存する必要があります。 ショートカットが作成され、プライベートな場所に保存されている場合、そのパッケージは、App-v 5.1 クライアントを実行しているコンピューターにローカルで公開されている必要があります。
 
-   既存の仮想パッケージを変換します。

Sequencer では、 **% TMP% \ \ スクラッチ**または **% TEMP% \ \ スクラッチ**ディレクトリと**temp**ディレクトリを使ってシーケンス中に一時ファイルを保存します。 Sequencer を実行しているコンピューターで、アプリケーションの推定インストール要件と同等の空きディスク領域を持つディレクトリを構成する必要があります。 ハードドライブのパーティションごとに temp ディレクトリと Temp ディレクトリを構成すると、シーケンス中のパフォーマンスが向上します。

Sequencer を使用して新しい仮想アプリケーションを作成すると、次の一覧のファイルが作成されます。 これらのファイルは、App-v 5.1 パッケージを構成します。

-   .msi ファイル。 この Windows Installer (.msi) ファイルは、sequencer によって作成され、仮想パッケージをターゲットコンピューターにインストールするために使用されます。

-   Report.xml ファイル。 このファイルでは、sequencer は、シーケンス中に検出されたすべての問題、警告、エラーを保存します。 パッケージが作成された後に情報が表示されます。 このレポートで、診断とトラブルシューティングを行うことができます。

-   appv ファイル。 これは、仮想アプリケーションファイルです。

-   展開構成ファイル。 展開構成ファイルによって、仮想アプリケーションがターゲットコンピューターにどのように展開されるかが決まります。

-   ユーザー構成ファイル。 ユーザー構成ファイルによって、ターゲットコンピューターで仮想アプリケーションが実行される方法が決まります。

**重要** パッケージコンバーターがセキュリティで保護された場所とディレクトリとして使用する% TMP% と% TEMP% フォルダーを構成する必要があります。 セキュリティで保護された場所には、管理者のみがアクセスできます。 さらに、パッケージをシーケンス処理するときには、セキュリティで保護された場所にパッケージを保存するか、変換と監視のプロセス中に他のユーザーがログインすることを許可されていることを確認してください。 

Sequencer コンソールの [**オプション**] ダイアログボックスには、次のタブがあります。

-   **[全般**] を選びます。 このタブを使用して、シーケンス中に Microsoft 更新プログラムを実行できるようにします。 順序を構成する仮想化されたパッケージにバージョン番号を追加するには、[**パッケージバージョンをファイル名に追加**する] を選択します。 [**パッケージアクセラレータのソースを常に信頼**する] を選択して、認証を求めるメッセージを表示せずに、パッケージアクセラレータを使用して仮想化されたパッケージを作成します。

    **重要** App-V 4.6 を使用して作成されたパッケージアクセラレータは、App-v 5.1 ではサポートされません。     

-   **項目を解析**する。 このタブには、仮想環境で解析またはトークン化される、関連付けられているファイルパスの場所が表示されます。 トークンは、**高度な編集**の [**パッケージファイル**] タブを使用してファイルを追加する場合に便利です。

-   **除外項目**。 このタブを使用して、シーケンス中に監視しないフォルダーとディレクトリを指定します。 パッケージのローカルアプリデータフォルダーに保存されているローカルアプリケーションデータを追加するには、[**新規**] をクリックし、場所と関連付けられている**マッピングの種類**を指定します。 一部のパッケージでは、このオプションが必要です。

App-v 5.1 では、Microsoft Windows サービスを含むアプリケーションがサポートされています。 アプリケーションに Windows サービスが含まれている場合、そのサービスは、sequencer によって監視されている間にインストールされていれば、シーケンス仮想パッケージに含まれます。 仮想アプリケーションが最初の実行時に Windows サービスを作成した場合、後でインストールした後、Windows サービスがパッケージに追加されるように、sequencer の監視中にアプリケーションを実行する必要があります。 ローカルシステムアカウントで実行されているサービスのみがサポートされます。 AutoStart または遅延 AutoStart 用に構成されているサービスは、パッケージ内の最初の仮想アプリケーションがパッケージの仮想環境内で実行される前に開始されます。 アプリケーションによってオンデマンドで開始されるように構成された Windows サービスは、パッケージ内の仮想アプリケーションが API 呼び出しによってサービスを開始したときに開始されます。

[APP-V 5.1 を使用して新しいアプリケーションをシーケンス処理する方法](how-to-sequence-a-new-application-with-app-v-51-beta-gb18030.md)

## <a href="" id="---------app-v-5-1-shell-extension-support"></a> App-v 5.1 シェル extension のサポート


App-v 5.1 では、シェルの拡張機能がサポートされています。 シェルの拡張機能が検出され、シーケンス中にパッケージに埋め込まれます。

シェルの拡張機能は、シーケンス処理中にパッケージに自動的に埋め込まれます。 パッケージが公開されると、シェルの拡張機能によって、アプリケーションがローカルにインストールされている場合と同じ機能をユーザーに提供できます。

**シェルの拡張機能を使用するための要件:**

-   埋め込まれたシェルの拡張機能を含むパッケージは、グローバルに公開する必要があります。 アプリケーションでは、シェルの拡張機能を有効にするために、クライアントで追加のセットアップや構成を行う必要はありません。

-   アプリケーション、Sequencer、および App-v クライアントの "ビット" は一致する必要があります。また、シェルの拡張機能は使用できません。 以下に例を示します。

    -   このアプリケーションのバージョンは64ビットです。

    -   Sequencer は64ビットコンピューターで実行されています。

    -   パッケージは、64ビットの App-v クライアントコンピューターに配信されます。

次の表に、サポートされているシェルの拡張機能を示します。

<table>
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">ハンドラー</th>
<th align="left">説明</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><p>コンテキストメニューハンドラー</p></td>
<td align="left"><p>コンテキストメニューにメニュー項目を追加します。 コンテキストメニューが表示される前に呼び出されます。</p></td>
</tr>
<tr class="even">
<td align="left"><p>ドラッグアンドドロップハンドラー</p></td>
<td align="left"><p>表示されるコンテキストメニューを右クリック、ドラッグアンドドロップ、変更したときの動作を制御します。</p></td>
</tr>
<tr class="odd">
<td align="left"><p>ドロップターゲットハンドラー</p></td>
<td align="left"><p>データオブジェクトがドラッグされて、ファイルなどのドロップターゲット上にドロップした後、アクションを制御します。</p></td>
</tr>
<tr class="even">
<td align="left"><p>データオブジェクトハンドラー</p></td>
<td align="left"><p>ファイルがクリップボードにコピーされた後、またはドロップターゲットをドラッグアンドドロップした後にアクションを制御します。 ドロップターゲットには、追加のクリップボード形式を指定できます。</p></td>
</tr>
<tr class="odd">
<td align="left"><p>プロパティシートハンドラー</p></td>
<td align="left"><p>ページをオブジェクトの [プロパティシート] ダイアログボックスに置換または追加します。</p></td>
</tr>
<tr class="even">
<td align="left"><p>ヒントハンドラー</p></td>
<td align="left"><p>マウスをポイントしたときに、アイテムのフラグとヒント情報を取得し、ポップアップツールヒント内に表示することができます。</p></td>
</tr>
<tr class="odd">
<td align="left"><p>列ハンドラー</p></td>
<td align="left"><p>Windows エクスプローラーの [詳細] ビューでカスタム列の作成と表示を行うことができ <strong> </strong> ます。 並べ替えとグループ化を拡張するために使うことができます。</p></td>
</tr>
<tr class="even">
<td align="left"><p>プレビューハンドラー</p></td>
<td align="left"><p>エクスプローラーのプレビューウィンドウにファイルのプレビューが表示されるようにします。</p></td>
</tr>
</tbody>
</table>

## 書き込み時のコピー (CoW) のファイル拡張子のサポート

書き込み時 (CoW) のファイル拡張子を使用すると、アプリが使用されている間、仮想パッケージに含まれている特定の場所に、アプリ5.1 では動的に書き込みを行うことができます。

次の表は、VFS ディレクトリにある仮想パッケージに存在する可能性があるファイルの種類を示していますが、App-v 5.1 クライアントを実行しているコンピューターでは更新できません。 その他のすべてのファイルとディレクトリは変更できます。

| ファイルの種類     |               |               |               |               |               |
|------------   |-------------  |-------------  |------------   |------------   |------------   |
| acm          | asa          | .asp          | .aspx         | ax           | .bat          |
| .cer          | .chm          | clb          | .cmd          | .cnt          | cnv          |
| .com          | .cpl          | cpx          | .crt          | .dll          | .drv          |
| . esc          | .exe          | .fon          | .grp          | .hlp          | .hta          |
| . ime          | .inf          | .ins          | .isp          | 。          | .js           |
| .jse          | .lnk          | .msc          | .msi          | .msp          | .mst          |
| mui          | nls          | .ocx          | pal          | .pcd          | .pif          |
| .reg          | .scf          | .scr          | sct          | .shb          | .shs          |
| .sys          | .tlb          | tsp          | .url          | .vb           | .vbe          |
| .vbs          | .vsmacros     | .ws           | .wsf          | .wsh          |               |


## 既存の仮想アプリケーションパッケージの変更


Sequencer を使って既存のパッケージを変更することができます。 この操作を行うコンピューターは、アプリケーションの作成に使用したコンピューターのチップアーキテクチャと一致している必要があります。 たとえば、最初に64ビットオペレーティングシステムを実行しているコンピューターを使ってパッケージを並べた場合は、64ビットオペレーティングシステムを実行しているコンピューターを使ってパッケージを変更する必要があります。

[既存の仮想アプリケーション パッケージを変更する方法](how-to-modify-an-existing-virtual-application-package-51.md)

## プロジェクトテンプレートを作成する


Appvt ファイルは、一般的に適用されるカスタマイズされた設定を保存するために使うことができるプロジェクトテンプレートです。 今後の sequencings では、これらの設定をより簡単に使うことができます。

App-v 5.1 のプロジェクトテンプレートは、app-v の5.1 アプリケーションアクセラレータがアプリケーション固有であり、App-v の5.1 プロジェクトテンプレートを複数のアプリケーションに適用できるため、app-v 5.1 アプリケーションアクセラレータとは異なります。 また、パッケージアクセラレータを使用して仮想アプリケーションパッケージを作成する場合、プロジェクトテンプレートを使用することはできません。 次の一般的な設定は、App-v 5.1 プロジェクトテンプレートと共に保存されています。

テンプレートでは、次のように複数の設定を指定して保存できます。

-   **高度な監視オプション**。 監視中に Microsoft Update を実行できるようにします。 ローカル操作オプションの設定を保存する

-   **[全般] オプション**。 **Windows インストーラー**の使用を有効にします。**ファイル名にパッケージバージョンを追加**します。

-   **除外項目。** 除外パターンリストが含まれています。

[プロジェクト テンプレートを作成して使用する方法](how-to-create-and-use-a-project-template51.md)

## パッケージアクセラレータの作成


**注** 以前のバージョンの App-v を使用して作成されたパッケージアクセラレータは、App-v 5.1 を使って再作成する必要があります。

App-v 5.1 パッケージアクセラレータを使って、新しい仮想アプリケーションパッケージを自動的に生成することができます。 パッケージアクセラレータの作成が正常に完了したら、パッケージアクセラレータを再利用して共有できます。

場合によっては、パッケージアクセラレータを作成するときに、sequencer を実行するコンピューターにローカルでアプリケーションをインストールすることが必要な場合があります。 このような場合は、最初にインストールメディアを使ってパッケージアクセラレータを作成する必要があります。 不足している複数のファイルが必要な場合は、sequencer を実行するコンピューターにローカルでアプリケーションをインストールしてから、パッケージアクセラレータを作成する必要があります。

パッケージアクセラレータの作成が正常に完了したら、パッケージアクセラレータを再利用して共有できます。 App-v 5.1 パッケージアクセラレータの作成は、高度なタスクです。 パッケージアクセラレータには、パスワードとユーザー固有の情報を含めることができます。 そのため、パッケージアクセラレータと関連するインストールメディアを安全な場所に保存する必要があります。また、パッケージアクセラレータを作成した後で、アプリを作成した後で、app-v 5.1 パッケージアクセラレータが適用されたときに、発行元を確認できるようにする必要があります。

[パッケージ アクセラレータを作成する方法](how-to-create-a-package-accelerator51.md)

[APP-V パッケージ アクセラレータを使用して仮想アプリケーション パッケージを作成する方法](how-to-create-a-virtual-application-package-using-an-app-v-package-accelerator51.md)

## Sequencer エラー報告


アプリ-V 5.1 Sequencer は、シーケンス中に一般的なシーケンスの問題を検出できます。 シーケンスウィザードの最後にある [**インストールレポート**] ページには、問題の重大度に応じて、**エラー**、**警告**、および**情報**に分類された診断メッセージが表示されます。

Windows イベントビューアーを使用して、シーケンスエラーに関する追加情報を見つけることもできます。


## <a href="" id="other-resources-for-the-app-v-5-1-sequencer-"></a>アプリのその他のリソース-V 5.1 sequencer


-   [APP-V 5.1 の操作](operations-for-app-v-51.md)

