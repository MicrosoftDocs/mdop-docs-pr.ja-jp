---
title: App-v 5.1 の動的構成について
description: 動的構成を使用して、ユーザーのために App-v 5.1 パッケージをカスタマイズすることができます。 既存の動的構成ファイルを作成または編集するには、次の情報を使用します。
author: dansimp
ms.assetid: 35bc9908-d502-4a9c-873f-8ee17b6d9d74
ms.reviewer: ''
manager: dansimp
ms.pagetype: mdop, appcompat, virtualization
ms.mktglfcycl: deploy
ms.sitesec: library
ms.prod: w10
ms.date: 08/28/2018
ms.author: dansimp
ms.openlocfilehash: ec8a25da6e139ac329810b1e04f7097cadaa6ab4
ms.sourcegitcommit: 354664bc527d93f80687cd2eba70d1eea024c7c3
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 06/26/2020
ms.locfileid: "10814964"
---
# <span data-ttu-id="50d4b-104">App-v 5.1 の動的構成について</span><span class="sxs-lookup"><span data-stu-id="50d4b-104">About App-V 5.1 dynamic configuration</span></span> 
<span data-ttu-id="50d4b-105">動的構成では、動的構成ファイルを編集して、ユーザーまたはグループに対して App-v 5.1 パッケージを実行する方法をカスタマイズできます。</span><span class="sxs-lookup"><span data-stu-id="50d4b-105">With dynamic configuration, you can edit the dynamic configuration file to customize how an App-V 5.1 package runs for a user or group.</span></span> <span data-ttu-id="50d4b-106">パッケージをカスタマイズすると、必要な設定を使ってシーケンスパッケージを再設定する必要がなくなります。</span><span class="sxs-lookup"><span data-stu-id="50d4b-106">Package customization removes the need to resequence packages using the desired settings.</span></span>  <span data-ttu-id="50d4b-107">また、パッケージコンテンツとカスタム設定を独立して保持する方法も提供されています。</span><span class="sxs-lookup"><span data-stu-id="50d4b-107">It also provides a way to keep package content and custom settings independent.</span></span>

<span data-ttu-id="50d4b-108">仮想アプリケーションパッケージには、パッケージのすべてのコア情報を提供するマニフェストが含まれています。</span><span class="sxs-lookup"><span data-stu-id="50d4b-108">Virtual application packages contain a manifest that provides all the core information for the package.</span></span> <span data-ttu-id="50d4b-109">この情報には、パッケージ設定の既定値が含まれており、最も基本的な形式 (追加のカスタマイズなし) で設定を決定します。</span><span class="sxs-lookup"><span data-stu-id="50d4b-109">This information includes the defaults for the package settings and determines settings in the most basic form (with no additional customization).</span></span> 

<span data-ttu-id="50d4b-110">パッケージを作成すると、sequencer はパッケージマニフェストデータを使用して、既定の展開とユーザー構成の .xml ファイルを自動的に生成します。</span><span class="sxs-lookup"><span data-stu-id="50d4b-110">When a package gets created, the sequencer generates default deployment and user configuration .xml files automatically using the package manifest data.</span></span> <span data-ttu-id="50d4b-111">そのため、これらの生成されたファイルには、シーケンス時に構成される既定の設定が反映されます。</span><span class="sxs-lookup"><span data-stu-id="50d4b-111">Therefore, these generated files reflect the default settings configured during sequencing.</span></span> <span data-ttu-id="50d4b-112">Sequencer によって生成されたフォームで、これらのファイルをパッケージに適用すると、そのマニフェストに由来する既定の設定がパッケージに適用されます。</span><span class="sxs-lookup"><span data-stu-id="50d4b-112">If you apply these files to a package in the form generated by the sequencer, the packages have the same default settings that came from their manifest.</span></span> 

<span data-ttu-id="50d4b-113">これらの生成されたファイルを使って、必要に応じて変更を加えます。これは、パッケージに直接影響を与えません。</span><span class="sxs-lookup"><span data-stu-id="50d4b-113">Use these generated files to make changes, if necessary, which doesn’t directly affect the package.</span></span> <span data-ttu-id="50d4b-114">構成ファイルを追加、削除、更新する場合は、マニフェスト情報の既定値について変更を加えます。</span><span class="sxs-lookup"><span data-stu-id="50d4b-114">If you want to add, delete or update the configuration files, make your changes about the default values in the manifest information.</span></span>

>[!TIP]
><span data-ttu-id="50d4b-115">ファイルの読み取り順序は次のとおりです。</span><span class="sxs-lookup"><span data-stu-id="50d4b-115">The order in which the files read are:</span></span><ul><li><span data-ttu-id="50d4b-116">UserConfig.xml</span><span class="sxs-lookup"><span data-stu-id="50d4b-116">UserConfig.xml</span></span></li><li><span data-ttu-id="50d4b-117">DeploymentConfig.xml</span><span class="sxs-lookup"><span data-stu-id="50d4b-117">DeploymentConfig.xml</span></span></li><li><span data-ttu-id="50d4b-118">ノート</span><span class="sxs-lookup"><span data-stu-id="50d4b-118">Manifest</span></span></li></ul><p><span data-ttu-id="50d4b-119">1つ目のエントリは、"前回の読み取り" を表します。</span><span class="sxs-lookup"><span data-stu-id="50d4b-119">The first entry represents what gets read last.</span></span> <span data-ttu-id="50d4b-120">そのため、コンテンツの優先順位が高くなり、すべてのパッケージには、パッケージマニフェストの既定の設定が含まれています。</span><span class="sxs-lookup"><span data-stu-id="50d4b-120">Therefore, its content takes precedence, and all packages inherently contain and provide default settings from the package manifest.</span></span><ol><li> <span data-ttu-id="50d4b-121">DeploymentConfig.xml ファイルをカスタマイズしてカスタマイズされた設定を適用する場合、パッケージマニフェストの既定の設定は上書きされます。</span><span class="sxs-lookup"><span data-stu-id="50d4b-121">If customizing the DeploymentConfig.xml file and apply the customized settings, the default settings in the package manifest get overridden.</span></span> </li><li> <span data-ttu-id="50d4b-122">UserConfig.xml をカスタマイズしてカスタマイズされた設定を適用する場合、展開構成とパッケージマニフェストの両方の既定の設定が上書きされます。</span><span class="sxs-lookup"><span data-stu-id="50d4b-122">If customizing the UserConfig.xml and apply the customized settings, the default settings for both the deployment configuration and the package manifest get overridden.</span></span> </li></ol>

## <span data-ttu-id="50d4b-123">ユーザー構成ファイルの内容 (UserConfig.xml)</span><span class="sxs-lookup"><span data-stu-id="50d4b-123">User configuration file contents (UserConfig.xml)</span></span>
<span data-ttu-id="50d4b-124">UserConfig ファイルには、App-v 5.1 クライアントを実行しているコンピューターにパッケージを展開するときに、特定のユーザーに適用される構成設定が用意されています。</span><span class="sxs-lookup"><span data-stu-id="50d4b-124">The UserConfig file provides configuration settings that get applied for a specific user when deploying the package to a computer running the App-V 5.1 client.</span></span>  <span data-ttu-id="50d4b-125">これらの設定は、クライアント上の他のユーザーに影響を与えません。</span><span class="sxs-lookup"><span data-stu-id="50d4b-125">These settings don’t affect any other users on the client.</span></span>

<span data-ttu-id="50d4b-126">ユーザー構成ファイルを使用して、パッケージのカスタム設定を指定または変更します。</span><span class="sxs-lookup"><span data-stu-id="50d4b-126">Use the UserConfig file to specify or modify custom settings for a package:</span></span>

-   <span data-ttu-id="50d4b-127">ユーザーごとのネイティブシステムに統合された拡張機能: ショートカット、ファイルの種類の関連付け、URL プロトコル、AppPaths、ソフトウェアクライアント、COM</span><span class="sxs-lookup"><span data-stu-id="50d4b-127">Extensions integrated into the native system per user: shortcuts, file-type associations, URL protocols, AppPaths, software clients and COM</span></span>
-   <span data-ttu-id="50d4b-128">仮想サブシステム: アプリケーションオブジェクト、環境変数、レジストリの変更、サービス、フォント</span><span class="sxs-lookup"><span data-stu-id="50d4b-128">Virtual subsystems: application objects, environment variables, registry modifications, services and fonts</span></span>
-   <span data-ttu-id="50d4b-129">スクリプト (ユーザーコンテキストのみ)</span><span class="sxs-lookup"><span data-stu-id="50d4b-129">Scripts (user context only)</span></span>
-   <span data-ttu-id="50d4b-130">権限の管理 (app-v 4.6 でパッケージの共存を制御するため)</span><span class="sxs-lookup"><span data-stu-id="50d4b-130">Managing authority (for controlling co-existence of package with App-V 4.6)</span></span>

### <span data-ttu-id="50d4b-131">ヘッダー</span><span class="sxs-lookup"><span data-stu-id="50d4b-131">Header</span></span>

<span data-ttu-id="50d4b-132">動的なユーザー構成ファイルのヘッダーは、次のようになります。</span><span class="sxs-lookup"><span data-stu-id="50d4b-132">The header of a dynamic user configuration file looks like:</span></span>

```xml
<?xml version="1.0" encoding="utf-8"?><UserConfiguration PackageId="1f8488bf-2257-46b4-b27f-09c9dbaae707" DisplayName="Reserved" xmlns="http://schemas.microsoft.com/appv/2010/userconfiguration">
```

<span data-ttu-id="50d4b-133">**PackageId**は、マニフェストファイルに存在する値と同じです。</span><span class="sxs-lookup"><span data-stu-id="50d4b-133">The **PackageId** is the same value as exists in the manifest file.</span></span>


### <span data-ttu-id="50d4b-134">本文</span><span class="sxs-lookup"><span data-stu-id="50d4b-134">Body</span></span>

<span data-ttu-id="50d4b-135">動的ユーザー構成ファイルの本文には、マニフェストファイルで定義されているすべてのアプリ拡張ポイントと、仮想アプリケーションを構成するための情報を含めることができます。</span><span class="sxs-lookup"><span data-stu-id="50d4b-135">The body of the dynamic user configuration file can include all the app extension points defined in the manifest file, as well as information to configure virtual applications.</span></span> <span data-ttu-id="50d4b-136">本文では、次の4つのサブセクションを使用できます。</span><span class="sxs-lookup"><span data-stu-id="50d4b-136">There are four subsections allowed in the body:</span></span>

1.  **[<span data-ttu-id="50d4b-137">アプリケーション</span><span class="sxs-lookup"><span data-stu-id="50d4b-137">Applications</span></span>](#applications)** 
2.  **[<span data-ttu-id="50d4b-138">サブシステム</span><span class="sxs-lookup"><span data-stu-id="50d4b-138">Subsystems</span></span>](#subsystems)**
3.  **[<span data-ttu-id="50d4b-139">UserScripts</span><span class="sxs-lookup"><span data-stu-id="50d4b-139">UserScripts</span></span>](#userscripts)**
4.  **[<span data-ttu-id="50d4b-140">ManagingAuthority</span><span class="sxs-lookup"><span data-stu-id="50d4b-140">ManagingAuthority</span></span>](#managingauthority)**

#### <span data-ttu-id="50d4b-141">アプリケーション</span><span class="sxs-lookup"><span data-stu-id="50d4b-141">Applications</span></span>

<span data-ttu-id="50d4b-142">パッケージ内のマニフェストファイルに含まれているすべてのアプリ拡張機能には、マニフェストファイルで見つかったアプリケーション ID が割り当てられています。</span><span class="sxs-lookup"><span data-stu-id="50d4b-142">All app-extensions contained in the manifest file within a package have an Application ID assigned, which you find in the manifest file.</span></span> <span data-ttu-id="50d4b-143">アプリケーション ID を使用すると、パッケージ内の特定のアプリケーションのすべての拡張機能を有効または無効にすることができます。</span><span class="sxs-lookup"><span data-stu-id="50d4b-143">The Application ID lets you enable or disable all extensions for a given application within a package.</span></span> <span data-ttu-id="50d4b-144">アプリケーション ID はマニフェストファイルに存在するか、無視されます。</span><span class="sxs-lookup"><span data-stu-id="50d4b-144">The Application ID must exist in the manifest file, or it gets ignored.</span></span>

```XML
<UserConfiguration PackageId="1f8488bf-2257-46b4-b27f-09c9dbaae707" DisplayName="Reserved"  xmlns="http://schemas.microsoft.com/appv/2010/userconfiguration">

<Applications>

<!--No new application can be defined in policy. AppV Client will ignore any application ID that is not also in the Manifest file-->

<Application Id="{a56fa627-c35f-4a01-9e79-7d36aed8225a}" Enabled="false">

</Application>

</Applications>

..

</UserConfiguration>
```

#### <span data-ttu-id="50d4b-145">サブシステム</span><span class="sxs-lookup"><span data-stu-id="50d4b-145">Subsystems</span></span>

<span data-ttu-id="50d4b-146">サブノードとして配置された AppExtensions とその他のサブシステム。</span><span class="sxs-lookup"><span data-stu-id="50d4b-146">AppExtensions and other subsystems arranged as subnodes.</span></span>

```XML
<UserConfiguration PackageId="1f8488bf-2257-46b4-b27f-09c9dbaae707" DisplayName="Reserved" xmlns="http://schemas.microsoft.com/appv/2010/userconfiguration">

<Subsystems>

..

</Subsystems>

..

</UserConfiguration>
```

<span data-ttu-id="50d4b-147">**有効化**属性を使って各サブシステムを有効または無効にすることができます。</span><span class="sxs-lookup"><span data-stu-id="50d4b-147">You can enable or disable each subsystem using the **Enabled** attribute.</span></span>

**<span data-ttu-id="50d4b-148">拡張機能</span><span class="sxs-lookup"><span data-stu-id="50d4b-148">Extensions</span></span>** 

<span data-ttu-id="50d4b-149">一部のサブシステム (拡張サブシステム) コントロールの拡張機能。</span><span class="sxs-lookup"><span data-stu-id="50d4b-149">Some subsystems (extension subsystems) control extensions.</span></span> <span data-ttu-id="50d4b-150">これらのサブシステムは、ショートカット、ファイルの種類の関連付け、URL プロトコル、AppPaths、ソフトウェアクライアント、COM です。</span><span class="sxs-lookup"><span data-stu-id="50d4b-150">Those subsystems are Shortcuts, File-Type associations, URL Protocols, AppPaths, Software Clients, and COM.</span></span>

<span data-ttu-id="50d4b-151">拡張サブシステムは、コンテンツとは別に有効または無効にすることができます。</span><span class="sxs-lookup"><span data-stu-id="50d4b-151">Extension subsystems can be enabled and disabled independently of the content.</span></span> <span data-ttu-id="50d4b-152">たとえば、ショートカットを有効にすると、既定ではマニフェスト内に含まれるショートカットが使用されます。</span><span class="sxs-lookup"><span data-stu-id="50d4b-152">For example, if you enable Shortcuts, the client uses the Shortcuts contained within the manifest by default.</span></span> <span data-ttu-id="50d4b-153">各拡張サブシステムには、ノードを含めることができ \<Extensions\> ます。</span><span class="sxs-lookup"><span data-stu-id="50d4b-153">Each extension subsystem can contain an \<Extensions\> node.</span></span> <span data-ttu-id="50d4b-154">この子要素が存在する場合、クライアントはそのサブシステムのマニフェストファイル内のコンテンツを無視し、構成ファイル内のコンテンツのみを使用します。</span><span class="sxs-lookup"><span data-stu-id="50d4b-154">If this child element is present, the client ignores the content in the manifest file for that subsystem and only use the content in the configuration file.</span></span> 

_**<span data-ttu-id="50d4b-155">例:</span><span class="sxs-lookup"><span data-stu-id="50d4b-155">Examples:</span></span>**_ 

- <span data-ttu-id="50d4b-156">これをユーザーまたは配置の構成ファイルで定義する場合、マニフェストのコンテンツは無視されます。</span><span class="sxs-lookup"><span data-stu-id="50d4b-156">If you define this in either the user or deployment config file, the content in the manifest gets ignored.</span></span>

  ```XML

  <Shortcuts  Enabled="true"\>

  <Extensions>

  ...

  </Extensions>

  </Shortcuts>
  ```
- <span data-ttu-id="50d4b-157">次のように定義した場合、マニフェストのコンテンツは発行中に統合されます。</span><span class="sxs-lookup"><span data-stu-id="50d4b-157">If you define only the following, the content in the manifest gets integrated during publishing.</span></span>

  ```XML

  <Shortcuts  Enabled="true"/>
  ```

- <span data-ttu-id="50d4b-158">次のように定義した場合、マニフェスト内のすべてのショートカットは無視されます。</span><span class="sxs-lookup"><span data-stu-id="50d4b-158">If you define the following, all Shortcuts within the manifest still get ignored.</span></span> <span data-ttu-id="50d4b-159">つまり、ショートカットは統合されません。</span><span class="sxs-lookup"><span data-stu-id="50d4b-159">In other words, no Shortcuts get integrated.</span></span>

  ```XML

  <Shortcuts  Enabled="true">

     <Extensions/>

  </Shortcuts>
  ```

_**<span data-ttu-id="50d4b-160">サポートされている拡張サブシステム:</span><span class="sxs-lookup"><span data-stu-id="50d4b-160">Supported extension subsystems:</span></span>**_ 

<span data-ttu-id="50d4b-161">**ショートカット**拡張サブシステムは、ローカルシステムに統合されたショートカットキーを制御します。</span><span class="sxs-lookup"><span data-stu-id="50d4b-161">**Shortcuts** extension subsystem controls what shortcuts get integrated into the local system.</span></span>  

```XML

<Subsystems>

<Shortcuts Enabled="true">

  <Extensions>

    <Extension Category="AppV.Shortcut">

      <Shortcut>

        <File>[{Common Programs}]\Microsoft Contoso\Microsoft ContosoApp Filler 2010.lnk</File>

        <Target>[{PackageRoot}]\Contoso\ContosoApp.EXE</Target>


      <Icon>[{Windows}]\Installer\{90140000-0011-0000-0000-0000000FF1CE}\inficon.exe</Icon>

        <Arguments />

        <WorkingDirectory />

        <AppUserModelId>ContosoApp.Filler.3</AppUserModelId>

        <Description>Fill out dynamic forms to gather and reuse information throughout the organization using Microsoft ContosoApp.</Description>

        <Hotkey>0</Hotkey>

        <ShowCommand>1</ShowCommand>

      <ApplicationId>[{PackageRoot}]\Contoso\ContosoApp.EXE</ApplicationId>

      </Shortcut>

  </Extension>

  <Extension Category="AppV.Shortcut">

    <Shortcut>

    <File>[{AppData}]\Microsoft\Contoso\Recent\Templates.LNK</File>

      <Target>[{AppData}]\Microsoft\Templates</Target>

      <Icon />

      <Arguments />

      <WorkingDirectory />

      <AppUserModelId />

      <Description />

      <Hotkey>0</Hotkey>

      <ShowCommand>1</ShowCommand>

      <!-- Note the ApplicationId is optional -->

    </Shortcut>

  </Extension>

 </Extensions>

</Shortcuts>
```

<span data-ttu-id="50d4b-162">**ファイルの種類に関連付け**られた拡張サブシステムは、既定で開くプログラムとファイルの種類を関連付け、コンテキストメニューを設定します。</span><span class="sxs-lookup"><span data-stu-id="50d4b-162">**File-Type Associates** extension subsystem associates file types with programs to open by default as well as set up the context menu.</span></span> 

>[!TIP]
><span data-ttu-id="50d4b-163">MIME タイプを使用してサブシステムを設定できます。</span><span class="sxs-lookup"><span data-stu-id="50d4b-163">You can set up the subsystem with MIME types.</span></span>

```XML

<FileTypeAssociations Enabled="true">

<Extensions>

  <Extension Category="AppV.FileTypeAssociation">

    <FileTypeAssociation>

      <FileExtension MimeAssociation="true">

      <Name>.docm</Name>

      <ProgId>contosowordpad.DocumentMacroEnabled.12</ProgId>

      <PerceivedType>document</PerceivedType>

    <ContentType>application/vnd.ms-contosowordpad.document.macroEnabled.12</ContentType>

      <OpenWithList>

        <ApplicationName>wincontosowordpad.exe</ApplicationName>

      </OpenWithList>

     <OpenWithProgIds>

        <ProgId>contosowordpad.8</ProgId>

      </OpenWithProgIds>

      <ShellNew>

        <Command />

        <DataBinary />

        <DataText />

        <FileName />

        <NullFile>true</NullFile>

        <ItemName />

        <IconPath />

        <MenuText />

        <Handler />

      </ShellNew>

    </FileExtension>

    <ProgId>

       <Name>contosowordpad.DocumentMacroEnabled.12</Name>

      <DefaultIcon\>[{Windows}]\Installer\{90140000-0011-0000-0000-000000FF1CE}\contosowordpadicon.exe,15</DefaultIcon>

        <Description>Blah Blah Blah</Description>

        <FriendlyTypeName>[{FOLDERID_ProgramFilesX86}]\Microsoft Contoso 14\res.dll,9182</FriendlyTypeName>

        <InfoTip>[{FOLDERID_ProgramFilesX86}]\Microsoft Contoso 14\res.dll,1424</InfoTip>

        <EditFlags>0</EditFlags>

        <ShellCommands>

          <DefaultCommand>Open</DefaultCommand>

          <ShellCommand>

           <ApplicationId>{e56fa627-c35f-4a01-9e79-7d36aed8225a}</ApplicationId>

             <Name>Edit</Name>

             <FriendlyName>&Edit</FriendlyName>

           <CommandLine>"[{PackageRoot}]\Contoso\WINcontosowordpad.EXE" /vu "%1"</CommandLine>

          </ShellCommand>

          </ShellCommand>

          <ApplicationId>{e56fa627-c35f-4a01-9e79-7d36aed8225a}</ApplicationId>

            <Name>Open</Name>

            <FriendlyName>&Open</FriendlyName>

            <CommandLine>"[{PackageRoot}]\Contoso\WINcontosowordpad.EXE" /n "%1"</CommandLine>

            <DropTargetClassId />

            <DdeExec>

              <Application>mscontosowordpad</Application>

              <Topic>ShellSystem</Topic>

              <IfExec>[SHELLNOOP]</IfExec>

              <DdeCommand>[SetForeground][ShellNewDatabase"%1"]</DdeCommand>

            </DdeExec>

          </ShellCommand>

        </ShellCommands>

      </ProgId>

     </FileTypeAssociation>

   </Extension>

  </Extensions>

  </FileTypeAssociations>
```

<span data-ttu-id="50d4b-164">**Url プロトコル**拡張サブシステムは、クライアントコンピューターのローカルレジストリに統合された url プロトコル ( _mailto:_ など) を制御します。</span><span class="sxs-lookup"><span data-stu-id="50d4b-164">**URL Protocols** extension subsystem controls the URL protocols integrated into the local registry of the client machine, for example, _mailto:_.</span></span> 

```XML

<URLProtocols Enabled="true">

<Extensions>

<Extension Category="AppV.URLProtocol">

<URLProtocol>

  <Name>mailto</Name>

  <ApplicationURLProtocol>

  <DefaultIcon>[{ProgramFilesX86}]\MicrosoftContoso\Contoso\contosomail.EXE,-9403</DefaultIcon>

  <EditFlags>2</EditFlags>

  <Description />

  <AppUserModelId />

  <FriendlyTypeName />

  <InfoTip />

<SourceFilter />

  <ShellFolder />

  <WebNavigableCLSID />

  <ExplorerFlags>2</ExplorerFlags>

  <CLSID />

  <ShellCommands>

  <DefaultCommand>open</DefaultCommand>

  <ShellCommand>

  <ApplicationId>[{ProgramFilesX86}]\Microsoft Contoso\Contoso\contosomail.EXE</ApplicationId>

  <Name>open</Name>

  <CommandLine>[{ProgramFilesX86}\Microsoft Contoso\Contoso\contosomail.EXE" -c OEP.Note /m "%1"</CommandLine>

  <DropTargetClassId />

  <FriendlyName />

  <Extended>0</Extended>

  <LegacyDisable>0</LegacyDisable>

  <SuppressionPolicy>2</SuppressionPolicy>

   <DdeExec>

  <NoActivateHandler />

  <Application>contosomail</Application>

  <Topic>ShellSystem</Topic>

  <IfExec>[SHELLNOOP]</IfExec>

  <DdeCommand>[SetForeground][ShellNewDatabase "%1"]</DdeCommand>

  </DdeExec>

  </ShellCommand>

  </ShellCommands>

  </ApplicationURLProtocol>

  </URLProtocol>

  </Extension>

  </Extension>

  </URLProtocols>
```

<span data-ttu-id="50d4b-165">**ソフトウェアクライアント**拡張サブシステムにより、アプリはメールクライアント、ニュースリーダー、メディアプレーヤーとして登録できます。また、アプリは [プログラムのアクセスとコンピューターの既定の設定] の UI に表示されます。</span><span class="sxs-lookup"><span data-stu-id="50d4b-165">**Software Clients** extension subsystem allows the app to register as an email client, news reader, media player and makes the app visible in the Set program access and Computer defaults UI.</span></span> <span data-ttu-id="50d4b-166">ほとんどの場合、有効または無効にする必要があります。</span><span class="sxs-lookup"><span data-stu-id="50d4b-166">In most cases, you should only need to enable and disable it.</span></span> <span data-ttu-id="50d4b-167">また、そのクライアントを除き、他のクライアントを引き続き有効にしたい場合は、メールクライアントを有効または無効にするコントロールもあります。</span><span class="sxs-lookup"><span data-stu-id="50d4b-167">There is also a control to enable and disable the email client specifically if you want the other clients still enabled except for that client.</span></span>

```XML

<SoftwareClients Enabled="true">

  <ClientConfiguration EmailEnabled="false" />

</SoftwareClients>
```

<span data-ttu-id="50d4b-168">**Apppaths** extension サブシステムは、アプリケーションパスと共に登録されているアプリを開きます。</span><span class="sxs-lookup"><span data-stu-id="50d4b-168">**AppPaths** extension subsystem opens apps registered with an application path.</span></span> <span data-ttu-id="50d4b-169">たとえば、contoso.exe に_myapp_という apppath 名が含まれている場合、ユーザーは [実行] メニューから「 _myapp_ 」と入力し、contoso.exe を開くことができます。</span><span class="sxs-lookup"><span data-stu-id="50d4b-169">For example, if contoso.exe has an apppath name of _myapp_, users can type _myapp_ from the run menu, opening contoso.exe.</span></span>

```XML

<AppPaths Enabled="true">

<Extensions>

<Extension Category="AppV.AppPath">

<AppPath>

  <ApplicationId>[{ProgramFilesX86}]\Microsoft Contoso\Contoso\contosomail.EXE</ApplicationId>

  <Name>contosomail.exe</Name>

  <ApplicationPath>[{ProgramFilesX86}]\Microsoft Contoso\Contoso\contosomail.EXE</ApplicationPath>

  <PATHEnvironmentVariablePrefix />

  <CanAcceptUrl>false</CanAcceptUrl>

  <SaveUrl />

</AppPath>

</Extension>

</Extensions>

</AppPaths>
```

<span data-ttu-id="50d4b-170">**Com**拡張機能サブシステムでは、アプリケーションをローカル com サーバーに登録できます。</span><span class="sxs-lookup"><span data-stu-id="50d4b-170">**COM** extensions subsystem allows an application registered to local COM servers.</span></span> <span data-ttu-id="50d4b-171">モードには次のものがあります。</span><span class="sxs-lookup"><span data-stu-id="50d4b-171">The mode can be:</span></span>

-   <span data-ttu-id="50d4b-172">His</span><span class="sxs-lookup"><span data-stu-id="50d4b-172">Integration</span></span>
-   <span data-ttu-id="50d4b-173">独立</span><span class="sxs-lookup"><span data-stu-id="50d4b-173">Isolated</span></span> 
-   <span data-ttu-id="50d4b-174">オフ</span><span class="sxs-lookup"><span data-stu-id="50d4b-174">Off</span></span>

```XML

<COM Mode="Isolated"/>
```

**<span data-ttu-id="50d4b-175">仮想カーネルオブジェクト</span><span class="sxs-lookup"><span data-stu-id="50d4b-175">Virtual Kernel Objects</span></span>**

```XML

<Objects Enabled="false" />
```

<span data-ttu-id="50d4b-176">**仮想レジストリ**によって、HKCU 内の仮想レジストリにレジストリが設定されます。</span><span class="sxs-lookup"><span data-stu-id="50d4b-176">**Virtual Registry** sets a registry in the virtual registry within HKCU.</span></span>

```XML

<Registry Enabled="true">

<Include>

<Key Path="\REGISTRY\USER\[{AppVCurrentUserSID}]\Software\ABC">

<Value Type="REG_SZ" Name="Bar" Data="NewValue" />

 </Key>

  <Key Path="\REGISTRY\USER\[{AppVCurrentUserSID}]\Software\EmptyKey" />

 </Include>

<Delete>

</Registry>
```

**<span data-ttu-id="50d4b-177">仮想ファイルシステム</span><span class="sxs-lookup"><span data-stu-id="50d4b-177">Virtual File System</span></span>**

```XML

    <FileSystem Enabled="true" />
```

**<span data-ttu-id="50d4b-178">仮想フォント</span><span class="sxs-lookup"><span data-stu-id="50d4b-178">Virtual Fonts</span></span>**

```XML

      <Fonts Enabled="false" />
```

**<span data-ttu-id="50d4b-179">仮想環境変数</span><span class="sxs-lookup"><span data-stu-id="50d4b-179">Virtual Environment Variables</span></span>**

```XML

<EnvironmentVariables Enabled="true">

<Include>

       <Variable Name="UserPath" Value="%path%;%UserProfile%" />

       <Variable Name="UserLib" Value="%UserProfile%\ABC" />

       </Include>

      <Delete>

       <Variable Name="lib" />

        </Delete>

        </EnvironmentVariables>
```

**<span data-ttu-id="50d4b-180">仮想サービス</span><span class="sxs-lookup"><span data-stu-id="50d4b-180">Virtual services</span></span>**

```XML

      <Services Enabled="false" />
```

#### <span data-ttu-id="50d4b-181">UserScripts</span><span class="sxs-lookup"><span data-stu-id="50d4b-181">UserScripts</span></span>

<span data-ttu-id="50d4b-182">UserScripts を使って仮想環境を設定または変更します。</span><span class="sxs-lookup"><span data-stu-id="50d4b-182">Use UserScripts to set up or alter the virtual environment.</span></span>  <span data-ttu-id="50d4b-183">また、展開時にスクリプトを実行したり、アプリケーションの終了後に環境をクリーンアップしたりすることもできます。</span><span class="sxs-lookup"><span data-stu-id="50d4b-183">You can also execute scripts at the time of deployment or to clean up the environment after the application terminates.</span></span> <span data-ttu-id="50d4b-184">サンプルスクリプトを確認するには、sequencer によって生成されたユーザー構成ファイルを参照してください。</span><span class="sxs-lookup"><span data-stu-id="50d4b-184">To see a sample script, refer to the user configuration file generated by the sequencer.</span></span> <span data-ttu-id="50d4b-185">以下のスクリプトセクションでは、使用できるさまざまなトリガーについて詳しく説明します。</span><span class="sxs-lookup"><span data-stu-id="50d4b-185">The Scripts section below provides more information on the various triggers that can be used.</span></span>

#### <span data-ttu-id="50d4b-186">ManagingAuthority</span><span class="sxs-lookup"><span data-stu-id="50d4b-186">ManagingAuthority</span></span>

<span data-ttu-id="50d4b-187">ManagingAuthority は、パッケージの2つのバージョンが同じコンピューター上に共存する場合に使用します。1つは App-v 4.6 に展開され、もう1つはアプリ V 5.0 に展開されます。</span><span class="sxs-lookup"><span data-stu-id="50d4b-187">Use ManagingAuthority when two versions of your package co-exist on the same machine, one deployed to App-V 4.6 and another deployed on App-V 5.0.</span></span> <span data-ttu-id="50d4b-188">名前付きパッケージの app-v 4.6 extension points に対して、次のようにしてアプリから V を使用できるようにするには、UserConfig ファイルで次のように入力します (この場合、PackageName は App-v 4.6 のパッケージ GUID です)。</span><span class="sxs-lookup"><span data-stu-id="50d4b-188">To allow App-V vNext to take over App-V 4.6 extension points for the named package enter the following in the UserConfig file (where PackageName is the Package GUID in App-V 4.6:</span></span>

```XML

<ManagingAuthority TakeoverExtensionPointsFrom46="true" PackageName="032630c0-b8e2-417c-acef-76fc5297fe81" />
```

## <span data-ttu-id="50d4b-189">展開構成ファイル (DeploymentConfig.xml)</span><span class="sxs-lookup"><span data-stu-id="50d4b-189">Deployment configuration file (DeploymentConfig.xml)</span></span>

<span data-ttu-id="50d4b-190">DeploymentConfig ファイルには、UserConfig ファイルに示されている機能と同じ機能を提供する、マシンコンテキストとユーザーコンテキストの構成設定が用意されています。</span><span class="sxs-lookup"><span data-stu-id="50d4b-190">The DeploymentConfig file provides configuration settings for machine context and user context, providing the same capabilities listed in the UserConfig file.</span></span> <span data-ttu-id="50d4b-191">App-v 5.1 クライアントを実行しているコンピューターにパッケージを展開するときに、設定が適用されます。</span><span class="sxs-lookup"><span data-stu-id="50d4b-191">The setting get applied when deploying the package to a computer running the App-V 5.1 client.</span></span>

<span data-ttu-id="50d4b-192">パッケージのカスタム設定を指定または変更するには、DeploymentConfig ファイルを使用します。</span><span class="sxs-lookup"><span data-stu-id="50d4b-192">Use the DeploymentConfig file to specify or modify custom settings for a package:</span></span>

- <span data-ttu-id="50d4b-193">すべての UserConfig 設定</span><span class="sxs-lookup"><span data-stu-id="50d4b-193">All UserConfig settings</span></span>
- <span data-ttu-id="50d4b-194">すべてのユーザーに対してグローバルに適用できる拡張機能</span><span class="sxs-lookup"><span data-stu-id="50d4b-194">Extensions that can only be applied globally for all users</span></span>
- <span data-ttu-id="50d4b-195">グローバルコンピューターの場所の仮想サブシステム (レジストリなど)</span><span class="sxs-lookup"><span data-stu-id="50d4b-195">Virtual subsystems for global machine locations, for example, registry</span></span>
- <span data-ttu-id="50d4b-196">製品ソースの URL</span><span class="sxs-lookup"><span data-stu-id="50d4b-196">Product source URL</span></span>
- <span data-ttu-id="50d4b-197">スクリプト (マシンコンテキストのみ)</span><span class="sxs-lookup"><span data-stu-id="50d4b-197">Scripts (machine context only)</span></span>
- <span data-ttu-id="50d4b-198">子プロセスを終了するためのコントロール</span><span class="sxs-lookup"><span data-stu-id="50d4b-198">Controls to terminate child processes</span></span>

### <span data-ttu-id="50d4b-199">ヘッダー</span><span class="sxs-lookup"><span data-stu-id="50d4b-199">Header</span></span>

<span data-ttu-id="50d4b-200">動的な配置構成ファイルのヘッダーは、次のようになります。</span><span class="sxs-lookup"><span data-stu-id="50d4b-200">The header of a dynamic deployment configuration file looks like:</span></span>

```XML
<?xml version="1.0" encoding="utf-8"?><DeploymentConfiguration PackageId="1f8488bf-2257-46b4-b27f-09c9dbaae707" DisplayName="Reserved" xmlns="http://schemas.microsoft.com/appv/2010/deploymentconfiguration">
```

<span data-ttu-id="50d4b-201">**PackageId**は、マニフェストファイルに存在する値と同じです。</span><span class="sxs-lookup"><span data-stu-id="50d4b-201">The **PackageId** is the same value as exists in the manifest file.</span></span>

### <span data-ttu-id="50d4b-202">本文</span><span class="sxs-lookup"><span data-stu-id="50d4b-202">Body</span></span>

<span data-ttu-id="50d4b-203">動的な展開構成ファイルの本文には、次の2つのセクションがあります。</span><span class="sxs-lookup"><span data-stu-id="50d4b-203">The body of the dynamic deployment configuration file includes two sections:</span></span>

- <span data-ttu-id="50d4b-204">**Userconfiguration:** 前のセクションで説明したユーザー構成ファイルと同じコンテンツを許可します。</span><span class="sxs-lookup"><span data-stu-id="50d4b-204">**UserConfiguration:** allows the same content as the user configuration file described in the previous section.</span></span>  <span data-ttu-id="50d4b-205">ユーザーにパッケージを公開する場合、ユーザー構成ファイルを指定しない限り、このセクションのすべての appextensions の構成設定は、パッケージ内のマニフェストで対応する設定を上書きします。</span><span class="sxs-lookup"><span data-stu-id="50d4b-205">When publishing the package to a user, any appextensions configuration settings in this section override corresponding settings in the manifest within the package, unless you provide a user configuration file.</span></span> <span data-ttu-id="50d4b-206">UserConfig ファイルも提供する場合は、展開構成ファイルのユーザー設定ではなく、そのファイルを使用します。</span><span class="sxs-lookup"><span data-stu-id="50d4b-206">If also providing a UserConfig file, it gets used instead of the User settings in the deployment configuration file.</span></span> <span data-ttu-id="50d4b-207">パッケージをグローバルに公開する場合、展開構成ファイルの内容のみがマニフェストと組み合わせて使用されます。</span><span class="sxs-lookup"><span data-stu-id="50d4b-207">If publishing the package globally, then only the contents of the deployment configuration file get used in combination with the manifest.</span></span> <span data-ttu-id="50d4b-208">詳細については、「[ユーザー構成ファイルの内容 (UserConfig.xml)](#user-configuration-file-contents-userconfigxml)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="50d4b-208">For more details, see [User configuration file contents (UserConfig.xml)](#user-configuration-file-contents-userconfigxml).</span></span>

- <span data-ttu-id="50d4b-209">[コンピューター]: マシンの特定のユーザーに対してではなく、コンピューター全体に対してのみ構成できる情報が含まれ**ます**。</span><span class="sxs-lookup"><span data-stu-id="50d4b-209">**MachineConfiguration:** contains information that can be configured only for an entire machine, not for a specific user on the machine.</span></span> <span data-ttu-id="50d4b-210">たとえば、VFS のレジストリキーを HKEY_LOCAL_MACHINE します。</span><span class="sxs-lookup"><span data-stu-id="50d4b-210">For example, HKEY_LOCAL_MACHINE registry keys in the VFS.</span></span>

```XML

<DeploymentConfiguration PackageId="1f8488bf-2257-46b4-b27f-09c9dbaae707" DisplayName="Reserved" xmlns="http://schemas.microsoft.com/appv/2010/deploymentconfiguration">

<UserConfiguration>

...

</UserConfiguration>

<MachineConfiguration>

...

</MachineConfiguration>

...

</MachineConfiguration>

</DeploymentConfiguration>
```

### <span data-ttu-id="50d4b-211">UserConfiguration</span><span class="sxs-lookup"><span data-stu-id="50d4b-211">UserConfiguration</span></span>

<span data-ttu-id="50d4b-212">このセクションで提供される設定の詳細については、「[ユーザー構成ファイルのコンテンツ (UserConfig.xml)](#user-configuration-file-contents-userconfigxml) 」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="50d4b-212">Refer to [User configuration file contents (UserConfig.xml)](#user-configuration-file-contents-userconfigxml) for information on the settings provided for this section.</span></span> 

### <span data-ttu-id="50d4b-213">コンピューターのしくみ</span><span class="sxs-lookup"><span data-stu-id="50d4b-213">MachineConfiguration</span></span>

<span data-ttu-id="50d4b-214">マシン全体の情報を構成するには、[コンピューターの構成] セクションを使用します。コンピューター上の特定のユーザーには使用できません。</span><span class="sxs-lookup"><span data-stu-id="50d4b-214">Use the MachineConfiguration section to configure information for an entire machine; not for a specific user on the computer.</span></span> <span data-ttu-id="50d4b-215">たとえば、仮想レジストリのレジストリキーを HKEY_LOCAL_MACHINE ます。</span><span class="sxs-lookup"><span data-stu-id="50d4b-215">For example, HKEY_LOCAL_MACHINE registry keys in the virtual registry.</span></span> <span data-ttu-id="50d4b-216">この要素では、次の4つのサブセクションを使用できます。</span><span class="sxs-lookup"><span data-stu-id="50d4b-216">There are four subsections allowed in under this element:</span></span>

1.  **[<span data-ttu-id="50d4b-217">サブシステム</span><span class="sxs-lookup"><span data-stu-id="50d4b-217">Subsystems</span></span>](#subsystems-1)**
2.  **[<span data-ttu-id="50d4b-218">ProductSourceURLOptOut</span><span class="sxs-lookup"><span data-stu-id="50d4b-218">ProductSourceURLOptOut</span></span>](#productsourceurloptout)**
3.  **[<span data-ttu-id="50d4b-219">MachineScripts</span><span class="sxs-lookup"><span data-stu-id="50d4b-219">MachineScripts</span></span>](#machinescripts)**
4.  **[<span data-ttu-id="50d4b-220">TerminateChildProcess</span><span class="sxs-lookup"><span data-stu-id="50d4b-220">TerminateChildProcess</span></span>](#terminatechildprocess)**

#### <span data-ttu-id="50d4b-221">サブシステム</span><span class="sxs-lookup"><span data-stu-id="50d4b-221">Subsystems</span></span>

<span data-ttu-id="50d4b-222">サブノードとして配置された AppExtensions とその他のサブシステム。</span><span class="sxs-lookup"><span data-stu-id="50d4b-222">AppExtensions and other subsystems arranged as subnodes.</span></span>

```XML

<MachineConfiguration>

  <Subsystems>

  …

  </Subsystems>

…

</MachineConfiguration>
```

<span data-ttu-id="50d4b-223">**有効化**属性を使って各サブシステムを有効または無効にすることができます。</span><span class="sxs-lookup"><span data-stu-id="50d4b-223">You can enable or disable each subsystem using the **Enabled** attribute.</span></span>

**<span data-ttu-id="50d4b-224">拡張機能</span><span class="sxs-lookup"><span data-stu-id="50d4b-224">Extensions</span></span>** 

<span data-ttu-id="50d4b-225">一部のサブシステム (拡張サブシステム) コントロールの拡張機能。</span><span class="sxs-lookup"><span data-stu-id="50d4b-225">Some subsystems (extension subsystems) control extensions.</span></span> <span data-ttu-id="50d4b-226">サブシステムは、既定のプログラムで使用するアプリケーション機能です。</span><span class="sxs-lookup"><span data-stu-id="50d4b-226">The subsystem is Application Capabilities that default programs use.</span></span> <span data-ttu-id="50d4b-227">この種類の拡張機能については、ローカルシステムに統合するためにパッケージをグローバルに公開する必要があります。</span><span class="sxs-lookup"><span data-stu-id="50d4b-227">For this type of extension, the package must be published globally for integration into the local system.</span></span> <span data-ttu-id="50d4b-228">ユーザー構成の拡張機能に適用されるコントロールと設定についても、[コンピューターの構成] セクションのコントロールと同じ規則に適用されます。</span><span class="sxs-lookup"><span data-stu-id="50d4b-228">The same rules for controls and settings that apply to the Extensions in the User Configuration also, apply to those in the MachineConfiguration section.</span></span>

<span data-ttu-id="50d4b-229">**アプリケーション機能**: アプリケーションが次のように登録できる既定のプログラムによって使用されます。</span><span class="sxs-lookup"><span data-stu-id="50d4b-229">**Application Capabilities**: Used by default programs that allow an application to register itself as:</span></span>

- <span data-ttu-id="50d4b-230">特定のファイル拡張子を開くことができる</span><span class="sxs-lookup"><span data-stu-id="50d4b-230">Capable of opening specific file extensions</span></span>
- <span data-ttu-id="50d4b-231">[スタート] メニューのインターネットブラウザースロットの contender</span><span class="sxs-lookup"><span data-stu-id="50d4b-231">A contender for the start menu internet browser slot</span></span>
- <span data-ttu-id="50d4b-232">特定の windows MIME タイプを開くことができる</span><span class="sxs-lookup"><span data-stu-id="50d4b-232">Capable of opening specific windows MIME types</span></span>

<span data-ttu-id="50d4b-233">この拡張機能により、仮想アプリケーションも [既定のプログラムの設定」の UI に表示されます。</span><span class="sxs-lookup"><span data-stu-id="50d4b-233">This extension also makes the virtual application visible in the Set default programs UI.</span></span>

```XML

<ApplicationCapabilities Enabled="true">

  <Extensions>

   <Extension Category="AppV.ApplicationCapabilities">

    <ApplicationCapabilities>


   <ApplicationId>[{PackageRoot}]\LitView\LitViewBrowser.exe</ApplicationId>

     <Reference>

      <Name>LitView Browser</Name>

      <Path>SOFTWARE\LitView\Browser\Capabilities</Path>

     </Reference>

   <CapabilityGroup>

    <Capabilities>


   <Name>@[{ProgramFilesX86}]\LitView\LitViewBrowser.exe,-12345</Name>


   <Description>@[{ProgramFilesX86}]\LitView\LitViewBrowser.exe,-12346</Description>

     <Hidden>0</Hidden>

     <EMailSoftwareClient>Lit View E-Mail Client</EMailSoftwareClient>

     <FileAssociationList>

      <FileAssociation Extension=".htm" ProgID="LitViewHTML" />

      <FileAssociation Extension=".html" ProgID="LitViewHTML" />

      <FileAssociation Extension=".shtml" ProgID="LitViewHTML" />

     </FileAssociationList>

     <MIMEAssociationList>

      <MIMEAssociation Type="audio/mp3" ProgID="LitViewHTML" />

      <MIMEAssociation Type="audio/mpeg" ProgID="LitViewHTML" />

     </MIMEAssociationList>

    <URLAssociationList>

      <URLAssociation Scheme="http" ProgID="LitViewHTML.URL.http" />

     </URLAssociationList>

     </Capabilities>

  </CapabilityGroup>

   </ApplicationCapabilities>

  </Extension>

</Extensions>

</ApplicationCapabilities>
```

_**<span data-ttu-id="50d4b-234">サポートされている拡張サブシステム:</span><span class="sxs-lookup"><span data-stu-id="50d4b-234">Supported extension subsystems:</span></span>**_ 

<span data-ttu-id="50d4b-235">**Machine Wide Virtual registry** extension subsystem は HKEY_Local_Machine 内の仮想レジストリにレジストリキーを設定します。</span><span class="sxs-lookup"><span data-stu-id="50d4b-235">**Machine Wide Virtual Registry** extension subsystem sets a registry key in the virtual registry within HKEY_Local_Machine.</span></span>

```XML

<Registry>

<Include>

  <Key Path="\REGISTRY\\Machine\Software\ABC">

    <Value Type="REG_SZ" Name="Bar" Data="Baz" />

   </Key>

  <Key Path="\REGISTRY\Machine\Software\EmptyKey" />

 </Include>

<Delete>

</Registry>
```

**<span data-ttu-id="50d4b-236">マシン全体の仮想カーネルオブジェクト</span><span class="sxs-lookup"><span data-stu-id="50d4b-236">Machine Wide Virtual Kernel Objects</span></span>**

```XML

<Objects>

<NotIsolate>

   <Object Name="testObject" />

 </NotIsolate>

</Objects>
```

#### <span data-ttu-id="50d4b-237">ProductSourceURLOptOut</span><span class="sxs-lookup"><span data-stu-id="50d4b-237">ProductSourceURLOptOut</span></span>

<span data-ttu-id="50d4b-238">ProductSourceURLOptOut を使って、パッケージの URL がパッケージ_パッケージ (ブランチ_オフィスのシナリオをサポートするため) でグローバルに変更できることを示します。</span><span class="sxs-lookup"><span data-stu-id="50d4b-238">Use ProductSourceURLOptOut to indicate that the URL for the package can be modified globally through _PackageSourceRoot_ (to support branch office scenarios).</span></span> <span data-ttu-id="50d4b-239">変更は次の起動時に有効になります。</span><span class="sxs-lookup"><span data-stu-id="50d4b-239">Changes take effect on the next launch.</span></span> 

```XML

<MachineConfiguration>

  ... 

  <ProductSourceURLOptOut Enabled="true" />

  ...

</MachineConfiguration>
```

#### <span data-ttu-id="50d4b-240">MachineScripts</span><span class="sxs-lookup"><span data-stu-id="50d4b-240">MachineScripts</span></span>

<span data-ttu-id="50d4b-241">パッケージは、展開、パブリッシング、または削除の時点でスクリプトを実行するように構成できます。</span><span class="sxs-lookup"><span data-stu-id="50d4b-241">The package can be configured to execute scripts at time of deployment, publishing or removal.</span></span> <span data-ttu-id="50d4b-242">サンプルスクリプトを確認するには、sequencer によって生成された展開構成ファイルを参照してください。</span><span class="sxs-lookup"><span data-stu-id="50d4b-242">To see a sample script, refer to the deployment configuration file generated by the sequencer.</span></span> 

<span data-ttu-id="50d4b-243">以下のスクリプトセクションでは、使用できるさまざまなトリガーについて詳しく説明します。</span><span class="sxs-lookup"><span data-stu-id="50d4b-243">The Scripts section below provides more information on the various triggers that can be used.</span></span>

#### <span data-ttu-id="50d4b-244">TerminateChildProcess</span><span class="sxs-lookup"><span data-stu-id="50d4b-244">TerminateChildProcess</span></span>

<span data-ttu-id="50d4b-245">アプリケーションの実行可能ファイルを指定して、アプリケーション exe プロセスが終了したときに子プロセスが終了するようにすることができます。</span><span class="sxs-lookup"><span data-stu-id="50d4b-245">An application executable can be specified, whose child processes get terminated when the application exe process terminates.</span></span>

```XML

<MachineConfiguration>

  ...   

  <TerminateChildProcesses>

    <Application Path="[{PackageRoot}]\Contoso\ContosoApp.EXE" />

    <Application Path="[{PackageRoot}]\LitView\LitViewBrowser.exe" />

    <Application Path="[{ProgramFilesX86}]\Microsoft Contoso\Contoso\contosomail.EXE" />

  </TerminateChildProcesses>

  ...

</MachineConfiguration>
```



## <span data-ttu-id="50d4b-246">スクリプト</span><span class="sxs-lookup"><span data-stu-id="50d4b-246">Scripts</span></span>

<span data-ttu-id="50d4b-247">次の表では、さまざまなスクリプトイベントと、それらを実行できるコンテキストについて説明します。</span><span class="sxs-lookup"><span data-stu-id="50d4b-247">The following table describes the various script events and the context under which they can be run.</span></span>

| <span data-ttu-id="50d4b-248">スクリプトの実行時間</span><span class="sxs-lookup"><span data-stu-id="50d4b-248">Script Execution Time</span></span>       | <span data-ttu-id="50d4b-249">展開構成で指定可能</span><span class="sxs-lookup"><span data-stu-id="50d4b-249">Can be specified in Deployment Configuration</span></span> | <span data-ttu-id="50d4b-250">ユーザー構成で指定可能</span><span class="sxs-lookup"><span data-stu-id="50d4b-250">Can be specified in User Configuration</span></span> | <span data-ttu-id="50d4b-251">パッケージの仮想環境で実行可能</span><span class="sxs-lookup"><span data-stu-id="50d4b-251">Can run in the Virtual Environment of the package</span></span> | <span data-ttu-id="50d4b-252">特定のアプリケーションのコンテキストで実行可能</span><span class="sxs-lookup"><span data-stu-id="50d4b-252">Can be run in the context of a specific application</span></span> | <span data-ttu-id="50d4b-253">システム/ユーザーコンテキストで実行されます: (展開構成、ユーザー構成)</span><span class="sxs-lookup"><span data-stu-id="50d4b-253">Runs in system/user context: (Deployment Configuration, User Configuration)</span></span> |
|-----------------------------|----------------------------------------------|----------------------------------------|---------------------------------------------------|-----------------------------------------------------|-----------------------------------------------------------------------------|
| <span data-ttu-id="50d4b-254">AddPackage</span><span class="sxs-lookup"><span data-stu-id="50d4b-254">AddPackage</span></span>                  | <span data-ttu-id="50d4b-255">○</span><span class="sxs-lookup"><span data-stu-id="50d4b-255">X</span></span>                                            |                                        |                                                   |                                                     | <span data-ttu-id="50d4b-256">(システム、該当なし)</span><span class="sxs-lookup"><span data-stu-id="50d4b-256">(SYSTEM, N/A)</span></span>                                                               |
| <span data-ttu-id="50d4b-257">PublishPackage</span><span class="sxs-lookup"><span data-stu-id="50d4b-257">PublishPackage</span></span>              | <span data-ttu-id="50d4b-258">○</span><span class="sxs-lookup"><span data-stu-id="50d4b-258">X</span></span>                                            | <span data-ttu-id="50d4b-259">○</span><span class="sxs-lookup"><span data-stu-id="50d4b-259">X</span></span>                                      |                                                   |                                                     | <span data-ttu-id="50d4b-260">(システム、ユーザー)</span><span class="sxs-lookup"><span data-stu-id="50d4b-260">(SYSTEM, User)</span></span>                                                              |
| <span data-ttu-id="50d4b-261">アンインストールパッケージ</span><span class="sxs-lookup"><span data-stu-id="50d4b-261">UnpublishPackage</span></span>            | <span data-ttu-id="50d4b-262">○</span><span class="sxs-lookup"><span data-stu-id="50d4b-262">X</span></span>                                            | <span data-ttu-id="50d4b-263">○</span><span class="sxs-lookup"><span data-stu-id="50d4b-263">X</span></span>                                      |                                                   |                                                     | <span data-ttu-id="50d4b-264">(システム、ユーザー)</span><span class="sxs-lookup"><span data-stu-id="50d4b-264">(SYSTEM, User)</span></span>                                                              |
| <span data-ttu-id="50d4b-265">RemovePackage</span><span class="sxs-lookup"><span data-stu-id="50d4b-265">RemovePackage</span></span>               | <span data-ttu-id="50d4b-266">○</span><span class="sxs-lookup"><span data-stu-id="50d4b-266">X</span></span>                                            |                                        |                                                   |                                                     | <span data-ttu-id="50d4b-267">(システム、該当なし)</span><span class="sxs-lookup"><span data-stu-id="50d4b-267">(SYSTEM, N/A)</span></span>                                                               |
| <span data-ttu-id="50d4b-268">StartProcess</span><span class="sxs-lookup"><span data-stu-id="50d4b-268">StartProcess</span></span>                | <span data-ttu-id="50d4b-269">○</span><span class="sxs-lookup"><span data-stu-id="50d4b-269">X</span></span>                                            | <span data-ttu-id="50d4b-270">○</span><span class="sxs-lookup"><span data-stu-id="50d4b-270">X</span></span>                                      | <span data-ttu-id="50d4b-271">○</span><span class="sxs-lookup"><span data-stu-id="50d4b-271">X</span></span>                                                 | <span data-ttu-id="50d4b-272">○</span><span class="sxs-lookup"><span data-stu-id="50d4b-272">X</span></span>                                                   | <span data-ttu-id="50d4b-273">(ユーザー、ユーザー)</span><span class="sxs-lookup"><span data-stu-id="50d4b-273">(User, User)</span></span>                                                                |
| <span data-ttu-id="50d4b-274">ExitProcess</span><span class="sxs-lookup"><span data-stu-id="50d4b-274">ExitProcess</span></span>                 | <span data-ttu-id="50d4b-275">○</span><span class="sxs-lookup"><span data-stu-id="50d4b-275">X</span></span>                                            | <span data-ttu-id="50d4b-276">○</span><span class="sxs-lookup"><span data-stu-id="50d4b-276">X</span></span>                                      |                                                   | <span data-ttu-id="50d4b-277">○</span><span class="sxs-lookup"><span data-stu-id="50d4b-277">X</span></span>                                                   | <span data-ttu-id="50d4b-278">(ユーザー、ユーザー)</span><span class="sxs-lookup"><span data-stu-id="50d4b-278">(User, User)</span></span>                                                                |
| <span data-ttu-id="50d4b-279">StartVirtualEnvironment</span><span class="sxs-lookup"><span data-stu-id="50d4b-279">StartVirtualEnvironment</span></span>     | <span data-ttu-id="50d4b-280">○</span><span class="sxs-lookup"><span data-stu-id="50d4b-280">X</span></span>                                            | <span data-ttu-id="50d4b-281">○</span><span class="sxs-lookup"><span data-stu-id="50d4b-281">X</span></span>                                      | <span data-ttu-id="50d4b-282">○</span><span class="sxs-lookup"><span data-stu-id="50d4b-282">X</span></span>                                                 |                                                     | <span data-ttu-id="50d4b-283">(ユーザー、ユーザー)</span><span class="sxs-lookup"><span data-stu-id="50d4b-283">(User, User)</span></span>                                                                |
| <span data-ttu-id="50d4b-284">TerminateVirtualEnvironment</span><span class="sxs-lookup"><span data-stu-id="50d4b-284">TerminateVirtualEnvironment</span></span> | <span data-ttu-id="50d4b-285">○</span><span class="sxs-lookup"><span data-stu-id="50d4b-285">X</span></span>                                            | <span data-ttu-id="50d4b-286">○</span><span class="sxs-lookup"><span data-stu-id="50d4b-286">X</span></span>                                      |                                                   |                                                     | <span data-ttu-id="50d4b-287">(ユーザー、ユーザー)</span><span class="sxs-lookup"><span data-stu-id="50d4b-287">(User, User)</span></span>                                                                |

### <span data-ttu-id="50d4b-288">1つのイベントトリガーでの複数のスクリプトの使用</span><span class="sxs-lookup"><span data-stu-id="50d4b-288">Using multiple scripts on a single event trigger</span></span>

<span data-ttu-id="50d4b-289">App-v 5.1 では、app-v パッケージの1つのイベントトリガーで複数のスクリプトを使うことができます。これには、App-v 4.6 から App-v 5.0 以降に変換されたパッケージが含まれています。</span><span class="sxs-lookup"><span data-stu-id="50d4b-289">App-V 5.1 supports the use of multiple scripts on a single event trigger for App-V packages, including packages that you convert from App-V 4.6 to App-V 5.0 or later.</span></span> <span data-ttu-id="50d4b-290">複数のスクリプトを使用できるようにするために、App-v 5.1 は、ScriptRunner.exe という名前のスクリプト起動アプリケーションを使用します。このアプリケーションは、App-v クライアントのインストールの一部としてインストールされます。</span><span class="sxs-lookup"><span data-stu-id="50d4b-290">To enable the use of multiple scripts, App-V 5.1 uses a script launcher application, named ScriptRunner.exe, which is installed as part of the App-V client installation.</span></span>

### <span data-ttu-id="50d4b-291">1つのイベントトリガーで複数のスクリプトを使用する方法</span><span class="sxs-lookup"><span data-stu-id="50d4b-291">How to use multiple scripts on a single event trigger</span></span>

<span data-ttu-id="50d4b-292">実行するスクリプトごとに、そのスクリプトを引数として ScriptRunner.exe アプリケーションに渡します。</span><span class="sxs-lookup"><span data-stu-id="50d4b-292">For each script that you want to run, pass that script as an argument to the ScriptRunner.exe application.</span></span> <span data-ttu-id="50d4b-293">その後、各スクリプトで指定した引数と共に、各スクリプトが個別に実行されます。</span><span class="sxs-lookup"><span data-stu-id="50d4b-293">The application then runs each script separately, along with the arguments that you specify for each script.</span></span> <span data-ttu-id="50d4b-294">トリガーごとに1つのスクリプト (ScriptRunner.exe) のみを使用します。</span><span class="sxs-lookup"><span data-stu-id="50d4b-294">Use only one script (ScriptRunner.exe) per trigger.</span></span>

> [!NOTE]
> 
> <span data-ttu-id="50d4b-295">最初に、コマンドプロンプトから複数のスクリプトを実行して、すべての引数が正しく構築されていることを確認してから展開構成ファイルに追加することをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="50d4b-295">We recommended that you run the multi-script line from a command prompt first to make sure that all arguments are built correctly before adding them to the deployment configuration file.</span></span>

### <span data-ttu-id="50d4b-296">スクリプトとパラメーターの説明の例</span><span class="sxs-lookup"><span data-stu-id="50d4b-296">Example script and parameter descriptions</span></span>

<span data-ttu-id="50d4b-297">次の例のファイルとテーブルを使って、展開またはユーザー構成ファイルを変更して、実行するスクリプトを追加します。</span><span class="sxs-lookup"><span data-stu-id="50d4b-297">Using the following example file and table, modify the deployment or user configuration file to add the scripts that you want to run.</span></span>

```XML
<MachineScripts>
 <AddPackage>
   <Path>ScriptRunner.exe</Path>
   <Arguments>
   -appvscript script1.exe arg1 arg2 –appvscriptrunnerparameters –wait –timeout=10
   -appvscript script2.vbs arg1 arg2
   -appvscript script3.bat arg1 arg2 –appvscriptrunnerparameters –wait –timeout=30 –rollbackonerror
   </Arguments>
   <Wait timeout=”40” RollbackOnError=”true”/>
 </AddPackage>
</MachineScripts>
```


**<span data-ttu-id="50d4b-298">サンプルファイルのパラメーターには、次のようなものがあります。</span><span class="sxs-lookup"><span data-stu-id="50d4b-298">Parameters in the example file include:</span></span>**

#### \<AddPackage\>

<span data-ttu-id="50d4b-299">パッケージの追加やパッケージの公開など、スクリプトを実行しているイベントトリガーの名前。</span><span class="sxs-lookup"><span data-stu-id="50d4b-299">Name of the event trigger for which you are running a script, such as adding a package or publishing a package.</span></span>

#### \<Path\><span data-ttu-id="50d4b-300">ScriptRunner.exe</span><span class="sxs-lookup"><span data-stu-id="50d4b-300">ScriptRunner.exe</span></span>\</Path\>

<span data-ttu-id="50d4b-301">App-v クライアントインストールの一部としてインストールされるスクリプト起動ツールアプリケーション。</span><span class="sxs-lookup"><span data-stu-id="50d4b-301">The script launcher application that is installed as part of the App-V client installation.</span></span>

> [!NOTE]
> 
> <span data-ttu-id="50d4b-302">ScriptRunner.exe は App-v クライアントの一部としてインストールされますが、App-v クライアントの場所は% path% にするか、ScriptRunner は実行されません。</span><span class="sxs-lookup"><span data-stu-id="50d4b-302">Although ScriptRunner.exe is installed as part of the App-V client, the location of the App-V client must be in %path% or ScriptRunner will not run.</span></span> <span data-ttu-id="50d4b-303">ScriptRunner.exe は、通常、C:FilesApplication Virtualizationfolder にあります。</span><span class="sxs-lookup"><span data-stu-id="50d4b-303">ScriptRunner.exe is typically located in the C:FilesApplication Virtualizationfolder.</span></span>

#### \<Arguments\>

`-appvscript` <span data-ttu-id="50d4b-304">-実行する実際のスクリプトを表すトークン。</span><span class="sxs-lookup"><span data-stu-id="50d4b-304">- Token that represents the actual script that you want to run.</span></span>

`script1.exe` <span data-ttu-id="50d4b-305">–実行するスクリプトの名前。</span><span class="sxs-lookup"><span data-stu-id="50d4b-305">– Name of the script that you want to run.</span></span>

`arg1 arg2` <span data-ttu-id="50d4b-306">–実行するスクリプトの引数。</span><span class="sxs-lookup"><span data-stu-id="50d4b-306">– Arguments for the script that you want to run.</span></span>

`-appvscriptrunnerparameters` <span data-ttu-id="50d4b-307">– script1.exe の実行オプションを表すトークン。</span><span class="sxs-lookup"><span data-stu-id="50d4b-307">– Token that represents the execution options for script1.exe.</span></span>

`-wait` <span data-ttu-id="50d4b-308">–次のスクリプトに進む前に script1.exe の実行が完了するまで待機することを ScriptRunner に通知するトークン。</span><span class="sxs-lookup"><span data-stu-id="50d4b-308">– Token that informs ScriptRunner to wait for execution of script1.exe to complete before proceeding to the next script.</span></span>

`-timeout=x` <span data-ttu-id="50d4b-309">– X 秒後に現在のスクリプトの実行を停止することを ScriptRunner に通知するトークン。</span><span class="sxs-lookup"><span data-stu-id="50d4b-309">– Token that informs ScriptRunner to stop running the current script after x number of seconds.</span></span> <span data-ttu-id="50d4b-310">その他の指定したすべてのスクリプトは引き続き実行されます。</span><span class="sxs-lookup"><span data-stu-id="50d4b-310">All other specified scripts still runs.</span></span>

`-rollbackonerror` <span data-ttu-id="50d4b-311">–まだ実行されていないすべてのスクリプトの実行を停止し、エラーを App-v クライアントにロールバックすることを ScriptRunner に通知するトークン。</span><span class="sxs-lookup"><span data-stu-id="50d4b-311">– Token that informs ScriptRunner to stop running all scripts that haven't yet run and to roll back an error to the App-V client.</span></span>

#### \<Wait timeout=”40” RollbackOnError=”true”/\>

<span data-ttu-id="50d4b-312">ScriptRunner.exe の全体が完了するまで待機します。</span><span class="sxs-lookup"><span data-stu-id="50d4b-312">Waits for overall completion of ScriptRunner.exe.</span></span>

<span data-ttu-id="50d4b-313">ランナー全体のタイムアウト値は、個々のスクリプトのタイムアウト値の合計以上になるように設定します。</span><span class="sxs-lookup"><span data-stu-id="50d4b-313">Set the timeout value for the overall runner to be greater than or equal to the sum of the timeout values on the individual scripts.</span></span>

<span data-ttu-id="50d4b-314">個々のスクリプトによってエラーが報告され、rollbackonerror が true に設定されている場合、ScriptRunner はエラーを App-v クライアントに報告します。</span><span class="sxs-lookup"><span data-stu-id="50d4b-314">If any individual script reported an error and rollbackonerror was set to true, then ScriptRunner would report the error to App-V client.</span></span>

<span data-ttu-id="50d4b-315">ScriptRunner は、ファイルの種類がコンピューターにインストールされているアプリケーションに関連付けられているスクリプトを実行します。</span><span class="sxs-lookup"><span data-stu-id="50d4b-315">ScriptRunner runs any script whose file type is associated with an application installed on the computer.</span></span> <span data-ttu-id="50d4b-316">関連付けられたアプリケーションが見つからない場合、またはスクリプトのファイルの種類がコンピューター上のアプリケーションに関連付けられていない場合、スクリプトは実行されません。</span><span class="sxs-lookup"><span data-stu-id="50d4b-316">If the associated application is missing, or the script’s file type is not associated with any application on the computer, the script does not run.</span></span>

### <span data-ttu-id="50d4b-317">App-v 5.1 マニフェストファイルを使用して動的構成ファイルを作成する</span><span class="sxs-lookup"><span data-stu-id="50d4b-317">Create a dynamic configuration file using an App-V 5.1 manifest file</span></span>

<span data-ttu-id="50d4b-318">動的構成ファイルを作成するには、次の3つの方法のいずれかを使用します。手動5.1 で行うか、またはパッケージをシーケンス処理して、2つのサンプルファイルを生成します。</span><span class="sxs-lookup"><span data-stu-id="50d4b-318">You can create the dynamic configuration file using one of three methods: either manually, using the App-V 5.1 Management Console or sequencing a package, which generates two sample files.</span></span> <span data-ttu-id="50d4b-319">App-v 5.1 管理コンソールを使用してファイルを作成する方法の詳細については、「app-v [5.1 管理コンソールを使用してカスタム構成ファイルを作成する方法](how-to-create-a-custom-configuration-file-by-using-the-app-v-51-management-console.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="50d4b-319">For more information about how to create the file using the App-V 5.1 Management Console see, [How to create a custom configuration File by using the App-V 5.1 Management Console](how-to-create-a-custom-configuration-file-by-using-the-app-v-51-management-console.md).</span></span>

<span data-ttu-id="50d4b-320">ファイルを手動で作成するには、前のセクションに記載されている情報を1つのファイルにまとめることができます。</span><span class="sxs-lookup"><span data-stu-id="50d4b-320">To create the file manually, the information above in previous sections can be combined into a single file.</span></span> <span data-ttu-id="50d4b-321">Sequencer によって生成されたファイルを使うことをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="50d4b-321">We recommend you use files generated by the sequencer.</span></span>



- <span data-ttu-id="50d4b-322">[ここで](http://appv.uservoice.com/forums/280448-microsoft-application-virtualization)候補を追加または投票してください。</span><span class="sxs-lookup"><span data-stu-id="50d4b-322">Add or vote on suggestions [here](http://appv.uservoice.com/forums/280448-microsoft-application-virtualization).</span></span>
- <span data-ttu-id="50d4b-323">App-v の問題については、 [app-v の TechNet フォーラムをご覧](https://social.technet.microsoft.com/Forums/home?forum=mdopappv)ください。</span><span class="sxs-lookup"><span data-stu-id="50d4b-323">For App-V issues, use the [App-V TechNet Forum](https://social.technet.microsoft.com/Forums/home?forum=mdopappv).</span></span>

## <span data-ttu-id="50d4b-324">関連トピック</span><span class="sxs-lookup"><span data-stu-id="50d4b-324">Related topics</span></span>

- [<span data-ttu-id="50d4b-325">PowerShell を使用して展開構成ファイルを適用する方法</span><span class="sxs-lookup"><span data-stu-id="50d4b-325">How to Apply the Deployment Configuration File by Using PowerShell</span></span>](how-to-apply-the-deployment-configuration-file-by-using-powershell51.md)

- [<span data-ttu-id="50d4b-326">PowerShell を使用してユーザー構成ファイルを適用する方法</span><span class="sxs-lookup"><span data-stu-id="50d4b-326">How to Apply the User Configuration File by Using PowerShell</span></span>](how-to-apply-the-user-configuration-file-by-using-powershell51.md)

- [<span data-ttu-id="50d4b-327">APP-V 5.1 の操作</span><span class="sxs-lookup"><span data-stu-id="50d4b-327">Operations for App-V 5.1</span></span>](operations-for-app-v-51.md)

---
