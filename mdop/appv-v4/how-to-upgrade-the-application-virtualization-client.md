---
title: Application Virtualization Client をアップグレードする方法
description: Application Virtualization Client をアップグレードする方法
author: dansimp
ms.assetid: 2a75d8b5-da88-456c-85bb-f5bd3d470f7f
ms.reviewer: ''
manager: dansimp
ms.author: dansimp
ms.pagetype: mdop, appcompat, virtualization
ms.mktglfcycl: deploy
ms.sitesec: library
ms.prod: w10
ms.date: 06/16/2016
ms.openlocfilehash: b9748fbdba7c8d2777a06c93295e4582be784dd1
ms.sourcegitcommit: 354664bc527d93f80687cd2eba70d1eea024c7c3
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 06/26/2020
ms.locfileid: "10816454"
---
# Application Virtualization Client をアップグレードする方法


次の手順を使用して、Application Virtualization (App-v) デスクトップクライアントまたはリモートデスクトップサービス (旧ターミナルサービス) の App-v クライアントをアップグレードできます。 クライアントをアップグレードするには、以前にインストールされていた以前のバージョンに新しいバージョンをインストールします。 クライアントをアップグレードすると、インストーラーソフトウェアによって仮想アプリケーションのユーザー設定が自動的に保存され、移行されます。 セットアッププログラムを実行するには、管理者権限が必要です。

**注** Application Virtualization (App-v) 4.5 以降のバージョンへのアップグレード中に、HKCU レジストリキーへのアクセス許可が変更されます。 このため、ユーザー構成の切断モードの設定など、以前に設定されたユーザー構成は失われます。 ユーザーが、アクセス許可のロックダウンを通じてクライアントユーザーインターフェイスの動作をまだ制限していない場合、ユーザーは公開の更新後にこれらの設定をリセットできます。

 

**重要** バージョン4.6 以降の App-v クライアントにアップグレードする場合は、コンピューターのオペレーティングシステム32ビットまたは64ビットに適切なインストーラーを使用する必要があります。 インストールが失敗し、誤ったインストーラーを使用した場合にエラーメッセージが表示されます。

 

**Application Virtualization デスクトップクライアントをアップグレードするには**

1.  すべての仮想アプリケーションをシャットダウンし、Windows デスクトップ通知領域に表示されている App-v デスクトップクライアントアイコンを右クリックして、[**終了**] を選択して既存のクライアントをシャットダウンします。

2.  適切なインストーラアーカイブファイルを取得してコンピューターに保存したら、それをダブルクリックしてアーカイブを展開します。

3.  [参照] をクリックして setup.exe ファイルを見つけ、[setup.exe] をダブルクリックしてインストールを開始します。

4.  ウィザードがシステムをチェックして、すべての必須ソフトウェアがインストールされていることを確認します。存在しない場合は、次のいずれかをインストールするように求められます。

    -   Microsoft VisualC + + 2005SP1 再頒布可能パッケージ (x86)

    -   Microsoft Core XML サービス (MSXML) 6.0 SP1 (x86)

    -   Microsoft アプリケーションエラー報告

    **注** バージョン4.6 以降では、ウィザードによって次のソフトウェアの前提条件もインストールされます。

    -   Microsoft VisualC + + 2008SP1 再頒布可能パッケージ (x86)

     

5.  **[インストール]** をクリックします。 インストールの進行状況が表示され、状態が [**保留中**] から [**インストール**中] に変わります。 各手順が正常に完了すると、インストールの状態が**成功**に変わります。

6.  [ **Application Virtualization Desktop Client** ] ダイアログが表示され、古いバージョンのクライアントがコンピューターで検出されたことを示すメッセージが表示されたら、[**次**へ] をクリックして新しいバージョンにアップグレードします。

7.  **ライセンス契約**の画面が表示されたら、ライセンス契約を読み、同意した場合は、[**使用許諾契約書に同意**します] をクリックし、[**次へ**] をクリックします。

8.  InstallShield ウィザードで [**プログラムをアップグレードする準備ができ**ました] ダイアログ画面が表示されたら、[**アップグレード**] をクリックしてアップグレードを開始します。 次の画面は、クライアントがインストールされていることを示します。

    **警告** 手順1でクライアントプログラムを終了していない場合は、[**使用中のファイル] の**警告が表示されることがあります。 この問題が発生した場合は、デスクトップ通知領域に表示されている App-v クライアントのアイコンを右クリックし、[**終了**] を選択して、既存のクライアントをシャットダウンします。 次に、[**再試行**] をクリックして続行します。

     

9.  インストールが正常に完了すると、コンピューターを再起動するように求められます。 インストールを完了するには、コンピューターを再起動する必要があります。

    **注意** 何らかの理由でアップグレードが失敗した場合は、もう一度アップグレードを試みる前にコンピューターを再起動する必要があります。

     

**コマンドラインを使用してアプリケーションの仮想化クライアントをアップグレードするには**

1.  setup.msi プログラムを使用して App-v クライアントをアップグレードする場合は、必要なすべての必須ソフトウェアがインストールされていることを確認します。

    **重要**  
    -   バージョン4.6 以降の App-v クライアントの場合、setup.msi プログラムはシステムをチェックし、必須のソフトウェアがインストールされていない場合はインストールを続行できないことを示すエラーメッセージが表示され、失敗します。

    -   App-v バージョン4.6 の場合、コマンドラインパラメーターはアップグレード時に使用できず、無視されます。

     

2.  次のコマンドラインの例では、setup.msi ファイルを使用して、App-v クライアントをアップグレードしています。 App-v デスクトップクライアントと、リモートデスクトップサービス (以前のターミナルサービス) 用の App-v クライアントのどちらをアップグレードするかによって、適切なクライアントインストーラープログラムを使用する必要があります。

    **msiexec.exe/i "setup.msi"**

    **重要** 引用符は、値にスペースが含まれている場合にのみ必要です。 一貫性を保つため、前の例のすべてのインスタンスは引用符で囲まれています。

     

**リモートデスクトップサービスのアプリケーション仮想化クライアントをアップグレードするには**

1.  組織の標準ポリシーに従って、リモートデスクトップセッションホスト (RDSession Host) サーバー上でアプリケーションをインストールまたはアップグレードします。 システムがファームの一部である場合は、サーバーファームから RDSession ホストを削除します。

2.  リモートデスクトップサービス (旧ターミナルサービス) の App-v クライアントをアップグレードするには、RDSession ホストでクライアントを手動でアップグレードできないため、コマンドラインを使用する必要があります。

    **注** App-v バージョン4.6 以降では、コマンドラインを使用してクライアントをアップグレードするだけでなく、リモートデスクトップセッションも使うことができます。 リモートデスクトップセッションを開始するために特別なパラメーターを指定する必要はありません。

     

3.  リモートデスクトップサービスのアップグレードが完了したら、クライアントを再起動して、RDSession ホストにログインします。

4.  システムを再起動したら、サーバーをサーバーファームに追加します。

    **注意** 何らかの理由でアップグレードが失敗した場合は、もう一度アップグレードを試みる前にコンピューターを再起動する必要があります。

     

## 関連トピック


[Application Virtualization の展開およびアップグレードに関する考慮事項](application-virtualization-deployment-and-upgrade-considerations.md)

 

 





